<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SafetyHelp | Community</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <style>
    /* Reset & Base */
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { 
      height: 100%; 
      font-family: 'Montserrat', sans-serif; 
      background: #E8F0FE; 
      color: #333; 
      display: flex;
      flex-direction: column;
    }
    a { text-decoration: none; color: inherit; }

    /* Header */
    header { 
      background: #007BFF; 
      color: #fff; 
      padding: 0.8rem 2rem; 
      display: flex; 
      align-items: center; 
      justify-content: space-between; 
      flex-shrink: 0;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .logo-container {
      display: flex;
      align-items: center;
      color: #fff; 
    }
    .logo-container img {
      height: 40px; 
      margin-right: 10px;
    }
    .logo { font-weight: 700; font-size: 1.75rem; letter-spacing: -0.025em; } 
    .logo .help { font-weight: 900; color: #FF8C00; }
    nav { display: flex; gap: 0.5rem; }
    nav a { 
      color: white; 
      font-weight: 500; 
      padding: 0.6rem 1rem; 
      border-radius: 6px; 
      transition: background-color 0.3s ease, transform 0.2s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      border: 1px solid transparent; 
    }
    nav a:hover, nav a.active-nav-link { 
      background-color: rgba(255,255,255,0.15); 
      transform: translateY(-2px);
      border-color: rgba(255,255,255,0.3);
    }
    nav a .nav-icon {
      font-size: 0.9em;
    }
    .search-language { display: flex; align-items: center; gap: 1rem; }
    .search-language input { padding: 0.6rem; border: 1px solid #ddd; border-radius: 6px; font-family: 'Montserrat', sans-serif; }
    .search-language select { padding: 0.6rem; border-radius: 6px; border: 1px solid #ddd; font-family: 'Montserrat', sans-serif; }

    /* Page Title Area */
    .page-title-section { 
      background: #F3F4F6; 
      padding: 1.5rem 2rem; 
      text-align: center; 
      border-bottom: 1px solid #e0e0e0;
      flex-shrink: 0;
    }
    .page-title-section h1 { font-size: 2.2rem; color: #1f2937; margin-bottom: 0.5rem; }
    .page-title-section p.subtitle { font-size: 1rem; color: #374151; max-width: 800px; margin-left: auto; margin-right: auto; }

    /* Layout */
    .page-content {
      display: flex;
      flex-direction: column;
      flex-grow: 1;
      overflow: hidden;
    }
    .container { 
      display: grid; 
      grid-template-columns: 1fr 3fr 1fr; 
      flex-grow: 1; 
      overflow: hidden; 
      min-height: 0;
      gap: 1rem; 
      padding: 1rem; 
    }
    .sidebar-tools, .sidebar-milestones { 
      background: #fff; 
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      display: flex;
      flex-direction: column;
      overflow: hidden; 
    }
    .sidebar-heading {
      font-size: 1.2rem;
      font-weight: 700;
      color: #007BFF;
      padding: 1rem;
      border-bottom: 1px solid #e5e7eb;
      background-color: #f9f9f9;
      flex-shrink: 0;
      border-top-left-radius: 8px;
      border-top-right-radius: 8px;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .sidebar-heading .heading-icon { color: #FF8C00; }
    .sidebar-list-container {
      flex-grow: 1;
      overflow: hidden; 
      position: relative; 
    }
    .sidebar-tools ul, .sidebar-milestones ul { 
      list-style: none; 
      padding: 0;
      margin: 0;
    }
    @keyframes alternatingScrollUp {
      0% { transform: translateY(0%); }
      100% { transform: translateY(-50%); }
    }
    @keyframes alternatingScrollDown {
      0% { transform: translateY(-50%); } 
      100% { transform: translateY(0%); }
    }
    .sidebar-tools ul { 
      animation: alternatingScrollDown 45s linear infinite alternate; 
    }
    .sidebar-milestones ul { 
      animation: alternatingScrollUp 40s linear infinite alternate; 
    }
    .sidebar-tools:hover ul, .sidebar-milestones:hover ul {
      animation-play-state: paused;
    }
    .sidebar-tools li, .sidebar-milestones li { 
      padding: 0; 
      border-bottom: 1px solid #e5e7eb; 
      cursor: pointer; 
      display: flex; 
    }
    .sidebar-tools li a, .sidebar-milestones li { 
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-size: 0.9rem;
      padding: 0.85rem 1rem; 
      width: 100%; 
      transition: background-color 0.3s ease;
      color: #333; 
    }
    .sidebar-tools li a:hover, .sidebar-milestones li:hover { 
      background: #e8f0fe; 
    }
    .sidebar-tools li a .list-icon, .sidebar-milestones li .list-icon { 
      color: #007BFF;
      font-size: 1em;
      width: 20px; 
      text-align: center;
    }
    /* Main content specific to Community Page */
    .main-community { 
      padding: 1.5rem; 
      overflow-y: auto; 
      background-color: #fff; 
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    .main-community section {
      margin-bottom: 2.5rem;
    }
    .main-community h2 {
      font-size: 1.8rem;
      color: #0056b3;
      margin-bottom: 1rem;
      padding-bottom: 0.5rem;
      border-bottom: 2px solid #FF8C00;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    .main-community h2 .section-icon {
      color: #FF8C00;
    }
    .main-community p {
      font-size: 1rem;
      line-height: 1.7;
      color: #374151;
      margin-bottom: 1rem;
    }
    .community-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }
    .community-actions .action-button {
      padding: 0.7rem 1.3rem;
      border-radius: 6px;
      font-weight: 500;
      transition: background-color 0.3s ease, transform 0.2s ease;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      cursor: pointer;
      border: none;
    }
    .action-button-primary {
      background-color: #007BFF;
      color: white;
    }
    .action-button-primary:hover {
      background-color: #0056b3;
      transform: translateY(-1px);
    }
    .action-button-secondary {
      background-color: #FF8C00;
      color: white;
    }
    .action-button-secondary:hover {
      background-color: #e07b00;
      transform: translateY(-1px);
    }
    .content-list {
      margin-top: 1rem;
      border: 1px solid #e0e0e0;
      border-radius: 6px;
      padding: 1rem;
      background-color: #f9f9f9;
    }
    .content-list .list-item {
      padding: 0.75rem 0;
      border-bottom: 1px dashed #ddd;
    }
    .content-list .list-item:last-child {
      border-bottom: none;
    }
    .content-list .list-item h4 {
      font-size: 1.1rem;
      color: #007BFF;
      margin-bottom: 0.25rem;
    }
    .content-list .list-item p {
      font-size: 0.9rem;
      color: #555;
      margin-bottom: 0.25rem;
    }
    .content-list .list-item .item-meta {
      font-size: 0.8rem;
      color: #777;
    }
    .content-list .list-item a {
      color: #FF8C00;
      text-decoration: underline;
    }
    .content-list .list-item a:hover {
      color: #e07b00;
    }
    #loadMoreArticlesBtn {
      margin-top: 1rem;
    }
    /* Footer */
    footer {
      background: #343a40; 
      color: #adb5bd; 
      text-align: center;
      padding: 1.5rem 2rem;
      font-size: 0.9rem;
      flex-shrink: 0;
      border-top: 3px solid #FF8C00;
    }
    footer p { margin-bottom: 0.5rem; }
    footer a { color: #FF8C00; transition: color 0.3s ease; }
    footer a:hover { color: #fff; }
    /* Modal Styles */
    .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6); padding-top: 60px; }
    .modal-content { background-color: #fefefe; margin: 5% auto; padding: 25px; border: 1px solid #888; width: 80%; max-width: 600px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); position: relative; }
    .modal-header { padding-bottom: 10px; border-bottom: 1px solid #eee; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; }
    .modal-header h4 { margin: 0; font-size: 1.4rem; color: #007BFF; }
    .close-btn { color: #aaa; font-size: 28px; font-weight: bold; cursor: pointer; transition: color 0.3s; }
    .close-btn:hover, .close-btn:focus { color: #333; text-decoration: none; }
    .modal-body { /* General modal body */ }
    .modal-body p { font-size: 1rem; line-height: 1.6; margin-bottom: 1rem; }
    .modal-body strong { color: #333; }
    .modal-body ul { list-style-type: disc; margin-left: 20px; margin-bottom: 1rem;}
    .modal-footer { padding-top: 15px; border-top: 1px solid #eee; margin-top: 20px; text-align: right; }
    .modal-footer button { background-color: #6c757d; color:white; border:none; padding: 0.7rem 1.3rem; border-radius:6px; cursor:pointer; } 
    .modal-footer button:hover { background-color: #5a6268; }
    /* Modal Form Styles */
    .modal-form .form-group { margin-bottom: 1rem; }
    .modal-form .form-group label { font-size: 0.9rem; margin-bottom: 0.3rem; }
    .modal-form .form-input, .modal-form .form-textarea { font-size: 0.95rem; padding: 0.6rem 0.8rem; }
    .modal-form .form-textarea { min-height: 80px; }
    /* Chatbot Styles */
    .chatbot-container { position: fixed; bottom: 20px; right: 20px; zážŸ

    <script>
      // Set current year in footer
      document.getElementById('copyright-year').textContent = new Date().getFullYear();

      // --- Sidebar Auto-Scrolling & Item Click ---
      function setupScrollingSidebar(listId) {
        const listElement = document.getElementById(listId);
        if (!listElement || listElement.children.length === 0) return;
        const originalItems = Array.from(listElement.children);
        originalItems.forEach(item => {
          const clone = item.cloneNode(true);
          if (listId === 'ohs-milestones-list') {
            clone.addEventListener('click', () => showMilestoneDetail(clone));
          }
          listElement.appendChild(clone);
        });
        originalItems.forEach(item => {
          if (listId === 'ohs-milestones-list') {
            item.addEventListener('click', () => showMilestoneDetail(item));
          }
        });
      }

      // --- Modal Functionality ---
      const modal = document.getElementById('infoModal');
      const modalTitle = document.getElementById('modalTitle');
      const modalBody = document.getElementById('modalBody');
      const modalFooter = document.getElementById('modalFooter');

      function showMilestoneDetail(element) {
        const title = element.textContent.trim().replace(/^.*? /,'');
        const detail = element.dataset.detail || "More information about this milestone will be available soon.";
        modalTitle.textContent = `OHS Milestone: ${title}`;
        modalBody.innerHTML = `<p>${detail}</p>`;
        modalFooter.innerHTML = `<button onclick="closeModal()" class="action-button-secondary"><i class="fas fa-times btn-icon"></i>Close</button>`;
        modal.style.display = 'block';
      }

      function closeModal() {
        modal.style.display = 'none';
        modalBody.innerHTML = '';
        modalFooter.innerHTML = `<button onclick="closeModal()" class="action-button-secondary"><i class="fas fa-times btn-icon"></i>Close</button>`;
      }

      window.onclick = function(event) {
        if (event.target == modal) {
          closeModal();
        }
      }

      // --- Community Page Specific JS ---
      // Mentorship
      const offerMentorshipBtn = document.getElementById('offerMentorshipBtn');
      const seekMentorshipBtn = document.getElementById('seekMentorshipBtn');
      const mentorshipList = document.getElementById('mentorshipList');

      if (offerMentorshipBtn) {
        offerMentorshipBtn.addEventListener('click', () => {
          modalTitle.textContent = "Offer Mentorship";
          modalBody.innerHTML = `
            <form id="offerMentorshipForm" class="modal-form">
              <div class="form-group">
                <label for="mentorName">Your Name:</label>
                <input type="text" id="mentorName" name="mentorName" class="form-input" required>
              </div>
              <div class="form-group">
                <label for="mentorExpertise">Area of Expertise:</label>
                <input type="text" id="mentorExpertise" name="mentorExpertise" class="form-input" required>
              </div>
              <div class="form-group">
                <label for="mentorContact">Contact (Email/Phone):</label>
                <input type="text" id="mentorContact" name="mentorContact" class="form-input" required>
              </div>
              <button type="submit" class="action-button action-button-primary"><i class="fas fa-paper-plane"></i>Submit Offer</button>
            </form>
          `;
          modalFooter.innerHTML = `<button onclick="closeModal()" class="action-button-secondary"><i class="fas fa-times btn-icon"></i>Cancel</button>`;
          modal.style.display = 'block';
          document.getElementById('offerMentorshipForm').addEventListener('submit', (e) => {
            e.preventDefault();
            console.log("Mentorship offer submitted:", Object.fromEntries(new FormData(e.target)));
            alert("Thank you for offering to mentor! We'll contact you to finalize your role.");
            closeModal();
          });
        });
      }

      if (seekMentorshipBtn) {
        seekMentorshipBtn.addEventListener('click', () => {
          modalTitle.textContent = "Seek Mentorship";
          modalBody.innerHTML = `
            <form id="seekMentorshipForm" class="modal-form">
              <div class="form-group">
                <label for="menteeName">Your Name:</label>
                <input type="text" id="menteeName" name="menteeName" class="form-input" required>
              </div>
              <div class="form-group">
                <label for="menteeNeed">What kind of mentorship are you seeking?</label>
                <textarea id="menteeNeed" name="menteeNeed" class="form-textarea" required></textarea>
              </div>
              <div class="form-group">
                <label for="menteeContact">Contact (Email/Phone):</label>
                <input type="text" id="menteeContact" name="menteeContact" class="form-input" required>
              </div>
              <button type="submit" class="action-button action-button-primary"><i class="fas fa-paper-plane"></i>Submit Request</button>
            </form>
          `;
          modalFooter.innerHTML = `<button onclick="closeModal()" class="action-button-secondary"><i class="fas fa-times btn-icon"></i>Cancel</button>`;
          modal.style.display = 'block';
          document.getElementById('seekMentorshipForm').addEventListener('submit', (e) => {
            e.preventDefault();
            console.log("Mentorship request submitted:", Object.fromEntries(new FormData(e.target)));
            alert("Thank you for your mentorship request! We'll match you with a mentor soon.");
            closeModal();
          });
        });
      }

      if (mentorshipList) mentorshipList.innerHTML = '<p class="list-item">Be the first to join our mentorship program! Sign up above.</p>';

      // Careers
      const postJobBtn = document.getElementById('postJobBtn');
      const submitCvBtn = document.getElementById('submitCvBtn');
      const jobList = document.getElementById('jobList');
      const searchCareersBtn = document.getElementById('searchCareersBtn');
      const careerSearchForm = document.getElementById('careerSearchForm');

      if (searchCareersBtn) {
        searchCareersBtn.addEventListener('click', () => {
          careerSearchForm.style.display = careerSearchForm.style.display === 'none' ? 'block' : 'none';
        });
      }

      if (postJobBtn) {
        postJobBtn.addEventListener('click', () => {
          modalTitle.textContent = "Post a Job Opening";
          modalBody.innerHTML = `
            <form id="postJobForm" class="modal-form">
              <div class="form-group">
                <label for="jobTitle">Job Title:</label>
                <input type="text" id="jobTitle" name="jobTitle" class="form-input" required>
              </div>
              <div class="form-group">
                <label for="jobCompany">Company Name:</label>
                <input type="text" id="jobCompany" name="jobCompany" class="form-input" required>
              </div>
              <div class="form-group">
                <label for="jobDescription">Job Description:</label>
                <textarea id="jobDescription" name="jobDescription" class="form-textarea" required></textarea>
              </div>
              <div class="form-group">
                <label for="jobContact">Application Contact/Link:</label>
                <input type="text" id="jobContact" name="jobContact" class="form-input" required>
              </div>
              <button type="submit" class="action-button action-button-primary"><i class="fas fa-paper-plane"></i>Post Job</button>
            </form>
          `;
          modalFooter.innerHTML = `<button onclick="closeModal()" class="action-button-secondary"><i class="fas fa-times btn-icon"></i>Cancel</button>`;
          modal.style.display = 'block';
          document.getElementById('postJobForm').addEventListener('submit', (e) => {
            e.preventDefault();
            console.log("Job posting submitted:", Object.fromEntries(new FormData(e.target)));
            alert("Job posting submitted! We'll review and post it soon.");
            closeModal();
          });
        });
      }

      if (submitCvBtn) {
        submitCvBtn.addEventListener('click', () => {
          modalTitle.textContent = "Submit Your CV";
          modalBody.innerHTML = `
            <form id="submitCvForm" class="modal-form">
              <div class="form-group">
                <label for="cvName">Your Name:</label>
                <input type="text" id="cvName" name="cvName" class="form-input" required>
              </div>
              <div class="form-group">
                <label for="cvSkills">Key Skills/Area of Interest:</label>
                <input type="text" id="cvSkills" name="cvSkills" class="form-input" required>
              </div>
              <div class="form-group">
                <label for="cvFile">Upload CV (PDF, DOCX):</label>
                <input type="file" id="cvFile" name="cvFile" class="form-input" accept=".pdf,.doc,.docx" required>
              </div>
              <div class="form-group">
                <label for="cvContact">Your Contact Email:</label>
                <input type="email" id="cvContact" name="cvContact" class="form-input" required>
              </div>
              <button type="submit" class="action-button action-button-primary"><i class="fas fa-paper-plane"></i>Submit CV</button>
            </form>
          `;
          modalFooter.innerHTML = `<button onclick="closeModal()" class="action-button-secondary"><i class="fas fa-times btn-icon"></i>Cancel</button>`;
          modal.style.display = 'block';
          document.getElementById('submitCvForm').addEventListener('submit', (e) => {
            e.preventDefault();
            console.log("CV submitted:", Object.fromEntries(new FormData(e.target)));
            alert("CV submitted! We'll share it with relevant employers.");
            closeModal();
          });
        });
      }

      // Adzuna API Integration
      const searchBtn = document.getElementById('searchBtn');
      if (searchBtn) {
        searchBtn.addEventListener('click', async () => {
          const searchType = document.getElementById('searchType').value;
          const location = document.getElementById('location').value || 'South Africa';
          const experience = document.getElementById('experience').value;
          let query = '';
          if (searchType === 'job') {
            query = experience === 'entry' ? 'trainee occupational health safety' : 'occupational health safety';
          } else if (searchType === 'training') {
            query = 'occupational health safety training';
          } else if (searchType === 'mentorship') {
            query = 'occupational health safety mentorship';
          } else if (searchType === 'scholarship') {
            query = 'occupational health safety scholarship';
          }
          try {
            const response = await fetch(`https://api.adzuna.com/v1/api/jobs/za/search/1?app_id=YOUR_ADZUNA_APP_ID&app_key=YOUR_ADZUNA_APP_KEY&what=${encodeURIComponent(query)}&where=${encodeURIComponent(location)}&content-type=application/json`);
            const data = await response.json();
            jobList.innerHTML = '';
            if (data.results && data.results.length > 0)
