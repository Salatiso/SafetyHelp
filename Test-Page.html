<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SafetyHelp | OHS System Management</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" xintegrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <style>
    /* Base styles from subpage_Final.html - Retained for consistency */
    body {
      font-family: 'Montserrat', sans-serif;
      background-color: #E8F0FE;
      color: #333;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      margin: 0;
    }
    header {
      background: #007BFF;
      color: #fff;
      padding: 0.8rem 2rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-shrink: 0;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 1001;
    }
    .logo-container { display: flex; align-items: center; color: #fff; text-decoration: none;}
    .logo { font-weight: 700; font-size: 1.75rem; letter-spacing: -0.025em; }
    .logo .help { font-weight: 900; color: #FF8C00; }
    nav { display: flex; flex-wrap: wrap; gap: 0.5rem; } /* Added flex-wrap for responsiveness */
    nav a {
      color: white;
      font-weight: 500;
      padding: 0.6rem 1rem;
      border-radius: 6px;
      transition: background-color 0.3s ease, transform 0.2s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      border: 1px solid transparent;
      text-decoration: none;
    }
    nav a:hover, nav a.active-nav-link {
      background-color: rgba(255,255,255,0.15);
      transform: translateY(-2px);
      border-color: rgba(255,255,255,0.3);
    }
    nav a .nav-icon { font-size: 0.9em; }
    .search-language { display: flex; align-items: center; gap: 1rem; }
    .search-language input, .search-language select {
      padding: 0.6rem;
      border: 1px solid #ddd;
      border-radius: 6px;
      font-family: 'Montserrat', sans-serif;
      background-color: #fff;
      color: #333;
      font-size: 0.9rem;
    }

    .page-title-section {
      background: #F3F4F6;
      padding: 1.5rem 2rem;
      text-align: center;
      border-bottom: 1px solid #e0e0e0;
      flex-shrink: 0;
    }
    .page-title-section h1 { font-size: 2.2rem; color: #1f2937; margin-bottom: 0.5rem; }
    .page-title-section p.subtitle { font-size: 1rem; color: #374151; max-width: 800px; margin-left: auto; margin-right: auto; }

    .page-content-container {
      display: flex;
      flex-grow: 1;
      overflow: hidden;
    }
    .container-grid {
      display: grid;
      grid-template-columns: 280px 1fr 280px; /* Adjusted sidebar width */
      flex-grow: 1;
      overflow: hidden;
      min-height: 0;
      gap: 1.5rem; /* Increased gap */
      padding: 1.5rem; /* Increased padding */
      max-height: calc(100vh - 160px); /* Adjusted based on header/footer/title height */
    }

    .sidebar-tools, .sidebar-milestones {
      background: #fff;
      border-radius: 10px; /* Slightly more rounded */
      box-shadow: 0 3px 8px rgba(0,0,0,0.07); /* Enhanced shadow */
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    .sidebar-heading {
      font-size: 1.25rem; /* Slightly larger heading */
      font-weight: 700;
      color: #007BFF;
      padding: 1rem 1.25rem; /* Adjusted padding */
      border-bottom: 1px solid #e0e0e0; /* Lighter border */
      background-color: #f8f9fa; /* Lighter heading background */
      flex-shrink: 0;
      border-top-left-radius: 10px;
      border-top-right-radius: 10px;
      display: flex;
      align-items: center;
      gap: 0.75rem; /* Increased gap */
    }
    .sidebar-heading .heading-icon { color: #FF8C00; font-size: 1.2em; }
    
    .sidebar-tools .sidebar-list-container {
        flex-grow: 1;
        overflow-y: auto;
        padding: 0.75rem; /* Adjusted padding */
    }
    .sidebar-tools ul { list-style: none; padding: 0; margin: 0; }
    .sidebar-tools li { margin-bottom: 0.6rem; /* Increased space */ }
    .sidebar-tools li a {
      display: flex; 
      align-items: center; 
      padding: 0.85rem 1.1rem; /* Adjusted padding */
      border-radius: 8px; /* More rounded */
      background-color: #f0f8ff; 
      color: #0056b3; 
      font-weight: 500;
      text-decoration: none;
      transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
      box-shadow: 0 2px 4px rgba(0,0,0,0.06); 
      gap: 0.85rem; 
    }
    .sidebar-tools li a:hover {
        background-color: #d6eaff; /* Lighter hover */
        transform: translateY(-1px) scale(1.01); /* More subtle lift */
        box-shadow: 0 4px 8px rgba(0,0,0,0.09);
    }
    .sidebar-tools li a.active-tool-link {
        background-color: #FF8C00; 
        color: white;
        font-weight: 700;
        box-shadow: 0 3px 7px rgba(255,140,0,0.35); 
    }
    .sidebar-tools li a.active-tool-link .list-icon { color: white; }
    .sidebar-tools li a .list-icon {
        color: #007BFF; 
        font-size: 1.1em; /* Slightly larger icon */
        width: 22px; /* Adjusted width */
        text-align: center;
        flex-shrink: 0; 
    }

    .sidebar-milestones .sidebar-list-container {
        flex-grow: 1;
        overflow: hidden; 
        position: relative;
    }
    .sidebar-milestones ul { list-style: none; padding: 0; margin: 0; }
    .sidebar-milestones:hover ul { animation-play-state: paused !important; }
     @keyframes continuousScrollUp {
        0% { transform: translateY(0%); }
        100% { transform: translateY(-50%); } 
    }
    .sidebar-milestones li { 
      padding: 0; 
      border-bottom: 1px solid #e5e7eb; 
      cursor: pointer; 
      display: flex; 
      align-items: center;
      gap: 0.75rem;
      font-size: 0.9rem;
      padding: 0.85rem 1rem; 
      width: 100%; 
      transition: background-color 0.3s ease;
      color: #333; 
      background-color: #fff; 
    }
    .sidebar-milestones li:hover { background: #e8f0fe; }
    .sidebar-milestones li .list-icon {
        color: #007BFF;
        font-size: 1em;
        width: 20px; 
        text-align: center;
        flex-shrink: 0;
    }

    .main-subpage-content {
      padding: 1.5rem;
      overflow-y: auto; 
      background-color: #fff;
      border-radius: 10px; /* More rounded */
      box-shadow: 0 3px 8px rgba(0,0,0,0.07); /* Enhanced shadow */
    }
    .main-subpage-content section { margin-bottom: 2.5rem; }
    .main-subpage-content h2 {
        font-size: 1.8rem;
        color: #0056b3; 
        margin-bottom: 1rem;
        padding-bottom: 0.5rem;
        border-bottom: 2px solid #FF8C00; 
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }
    .main-subpage-content h2 .section-icon { color: #FF8C00; font-size: 1.2em; }
    .main-subpage-content p { font-size: 1rem; line-height: 1.7; color: #374151; margin-bottom: 1rem; }
    .main-subpage-content ul:not(.document-category-list ul):not(#final-document-list) { list-style: disc; padding-left: 20px; } /* Avoid styling custom lists */
    
    .main-subpage-content details summary {
      cursor: pointer;
      font-weight: 600;
      padding: 0.85rem 1.25rem; /* Adjusted padding */
      background-color: #f0f8ff; 
      border: 1px solid #d1e7fd;
      border-radius: 8px; /* More rounded */
      margin-bottom: 0.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      transition: background-color 0.2s ease;
      font-size: 1.05em; /* Slightly larger summary text */
    }
    .main-subpage-content details summary:hover { background-color: #d6eaff; }
    .main-subpage-content details summary::after {
      content: '\\f078'; 
      font-family: 'Font Awesome 6 Free';
      font-weight: 900;
      transition: transform 0.2s ease-in-out;
      color: #007BFF;
    }
    .main-subpage-content details[open] summary::after { transform: rotate(180deg); }
    .main-subpage-content details > div { 
      padding: 1.25rem; /* Adjusted padding */
      border: 1px solid #e0e0e0;
      border-top: none;
      border-radius: 0 0 8px 8px; /* More rounded */
      background-color: #fdfdff; 
    }
    .main-subpage-content details div a { color: #007BFF; text-decoration: underline; }
    .main-subpage-content details div a:hover { color: #0056b3; }

    .action-button {
        padding: 0.8rem 1.6rem; /* Slightly larger buttons */
        border-radius: 8px; /* More rounded */
        font-weight: 600; /* Bolder text */
        transition: background-color 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.6rem; /* Increased gap */
        text-align: center;
        cursor: pointer;
        border: none; 
        text-decoration: none; 
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .action-button:hover {
        box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }
    .action-button-primary { background-color: #007BFF; color: white; }
    .action-button-primary:hover { background-color: #0056b3; transform: translateY(-2px); }
    .action-button-secondary { background-color: #FF8C00; color: white; }
    .action-button-secondary:hover { background-color: #e07b00; transform: translateY(-2px); }
    .action-button-tertiary { background-color: #5a6268; color: white; } /* Darker grey for tertiary */
    .action-button-tertiary:hover { background-color: #495057; transform: translateY(-2px); }
    
    .interaction-buttons-container {
      display: flex;
      flex-direction: column; 
      gap: 1.25rem; /* Increased gap */
      margin-top: 1.25rem; 
      margin-bottom: 2rem; 
    }
    .interaction-buttons-container .action-button { flex: 1; }

    @media (min-width: 768px) { 
      .interaction-buttons-container { flex-direction: row; }
    }

    .nav-buttons { margin-top: 1.5rem; display: flex; justify-content: space-between; gap: 1rem; }
    
    .wizard-step { border: 1px solid #e0e0e0; border-radius: 10px; padding: 1.75rem; margin-top: 1.5rem; background-color: #fdfdff; box-shadow: 0 2px 5px rgba(0,0,0,0.04); }
    .wizard-step h3, .wizard-step h4 { font-size: 1.6rem; color: #0056b3; margin-bottom: 1.25rem; }
    .wizard-step h4 { font-size: 1.35rem; color: #0067a3; margin-top: 1.75rem;}

    .form-group { margin-bottom: 1.25rem; }
    .form-group label { display: block; font-weight: 600; margin-bottom: 0.5rem; color: #374151; font-size: 1rem; }
    .form-group input[type="text"],
    .form-group input[type="email"],
    .form-group input[type="tel"],
    .form-group input[type="number"],
    .form-group input[type="date"],
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 0.75rem 1rem; /* Increased padding */
      border: 1px solid #ced4da; /* Slightly darker border */
      border-radius: 8px; /* More rounded */
      font-family: 'Montserrat', sans-serif;
      font-size: 1rem; /* Larger font */
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
      box-sizing: border-box; 
    }
    .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
      border-color: #007BFF;
      box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.2); /* Adjusted focus shadow */
      outline: none;
    }
    .form-group .checkbox-group label, .form-group .radio-group label { display: inline-flex; align-items: center; margin-right: 1.5rem; font-weight: normal; cursor:pointer; font-size: 0.95rem;}
    .form-group .checkbox-group input, .form-group .radio-group input { margin-right: 0.6rem; transform: scale(1.1); }
    .form-group .description { font-size: 0.9rem; color: #555; margin-top: 0.3rem; }
    
    .document-category-list { margin-top: 1rem; }
    .document-category-list details summary { font-size: 1.25rem; background-color: #e8f0fe; padding: 0.85rem 1.25rem; }
    .document-category-list details summary:hover { background-color: #d4e2f7; }
    .document-category-list details > div { background-color: #fff; padding: 1rem; }
    .document-item { display: flex; align-items: flex-start; padding: 0.85rem 0.6rem; border-bottom: 1px solid #f1f1f1; }
    .document-item:last-child { border-bottom: none; }
    .document-item input[type="checkbox"] { margin-top: 0.3rem; margin-right: 0.85rem; flex-shrink: 0; transform: scale(1.2); }
    .document-item-info { flex-grow: 1; }
    .document-item-info strong { display: block; font-size: 1.05rem; color: #0056b3; margin-bottom: 0.3rem; }
    .document-item-info p { font-size: 0.9rem; color: #555; margin-bottom: 0; line-height: 1.5; }
    .document-item-info .fas { margin-right: 0.4rem; color: #FF8C00; }
    .recommendation-explanation { background-color: #fff3cd; border-left: 4px solid #ffeeba; padding: 1rem; margin: 1rem 0; border-radius: 4px; font-size:0.95rem; }
    .recommendation-explanation p { margin-bottom: 0.5rem; }
    .select-all-buttons { margin-bottom: 1rem; display: flex; gap: 0.5rem; }

    .accordion-container { }
    .accordion-item { margin-bottom: 1rem; }
    .accordion-button {
        background-color: #007BFF; 
        color: white;
        padding: 1rem 1.5rem;
        border-radius: 0.5rem;
        font-weight: 700;
        font-size: 1.1rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: space-between;
        border: none;
        width: 100%;
        text-align: left;
        transition: background-color 0.2s ease;
    }
    .accordion-button:hover { background-color: #0056b3; }
    .accordion-button .fas.fa-chevron-down, .accordion-button .fas.fa-chevron-up { 
        transition: transform 0.3s ease;
        color: #FF8C00; 
    }
    .accordion-button.expanded .fas.fa-chevron-down, .accordion-button.expanded .fas.fa-chevron-up { transform: rotate(180deg); }
    .accordion-content {
        display: none;
        margin-top: 0; 
        padding: 1.5rem;
        background-color: #f9f9f9; 
        border-radius: 0 0 0.5rem 0.5rem; 
        border: 1px solid #e0e0e0;
        border-top: none; 
        animation: fadeIn 0.5s ease-out;
    }
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(-10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    .resource-item { 
        padding: 1rem;
        margin-bottom: 1rem;
        background-color: #ffffff;
        border: 1px solid #e0e0e0;
        border-radius: 0.5rem;
    }
    .resource-item:last-child { margin-bottom: 0; }
    .resource-item h4 {
        font-size: 1.1rem;
        font-weight: 600;
        color: #0056b3; 
        margin-bottom: 0.5rem;
        display: flex;
        align-items: center;
    }
    .resource-item h4 .fas { margin-right: 0.75rem; color: #FF8C00; }
    .resource-item p { font-size: 0.95rem; color: #374151; margin-bottom: 0.5rem; line-height: 1.6; }
    .resource-item .links a { margin-right: 1rem; font-size: 0.9rem; color: #007BFF; text-decoration: underline; cursor: pointer; }
    .resource-item .links a:hover { color: #0056b3; }
    .resource-item .links a i { margin-right: 0.3rem; }

    .review-section { margin-bottom: 1.5rem; }
    .review-section h4 { font-size: 1.2rem; color: #0056b3; margin-bottom: 0.5rem; border-bottom: 1px solid #eee; padding-bottom: 0.25rem;}
    .review-section p { font-size: 1rem; margin-bottom: 0.3rem; }
    .review-section p strong { color: #333; }
    .review-section ul { list-style: disc; margin-left: 20px; }
    .review-section ul li { font-size: 0.95rem; margin-bottom: 0.25rem; }

    footer {
      background: #343a40; 
      color: #adb5bd;
      text-align: center;
      padding: 1.5rem 2rem;
      font-size: 0.9rem;
      flex-shrink: 0;
      border-top: 3px solid #FF8C00; 
    }
    footer p { margin-bottom: 0.5rem; }
    footer a { color: #FF8C00; transition: color 0.3s ease; text-decoration: none;}
    footer a:hover { color: #fff; }

    .modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6); padding-top: 60px; }
    .modal-content { background-color: #fefefe; margin: 5% auto; padding: 25px; border: 1px solid #888; width: 80%; max-width: 600px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); position: relative; }
    .modal-header { padding-bottom: 10px; border-bottom: 1px solid #eee; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; }
    .modal-header h4 { margin: 0; font-size: 1.4rem; color: #007BFF; }
    .close-btn { color: #aaa; font-size: 28px; font-weight: bold; cursor: pointer; transition: color 0.3s; }
    .close-btn:hover, .close-btn:focus { color: #333; text-decoration: none; }
    .modal-body p { font-size: 1rem; line-height: 1.6; margin-bottom: 1rem; }
    .modal-footer { padding-top: 15px; border-top: 1px solid #eee; margin-top: 20px; text-align: right; }
    .modal-footer .action-button-secondary { background-color: #6c757d; }
    .modal-footer .action-button-secondary:hover { background-color: #5a6268; }

    .chatbot-container { position: fixed; bottom: 20px; right: 20px; z-index: 1050; }
    #chat-toggle { background-color: #FF8C00; color: white; border: none; border-radius: 50%; width: 60px; height: 60px; font-size: 1.8rem; box-shadow: 0 4px 8px rgba(0,0,0,0.2); cursor: pointer; display: flex; align-items: center; justify-content: center; transition: background-color 0.3s ease, transform 0.3s ease; }
    #chat-toggle:hover { background-color: #e07b00; transform: scale(1.1); }
    #chat-window { width: 320px; max-height: 450px; background-color: #fff; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); display: flex; flex-direction: column; overflow: hidden; transition: opacity 0.3s ease, transform 0.3s ease; position: absolute; bottom: 75px; right: 0; opacity: 0; transform: translateY(10px); pointer-events: none; }
    #chat-window.chat-expanded { opacity: 1; transform: translateY(0); pointer-events: auto; }
    .chat-hidden { display: none !important; } 
    #chat-header { background-color: #007BFF; color: white; padding: 10px 15px; font-weight: 600; border-top-left-radius: 10px; border-top-right-radius: 10px; display: flex; justify-content: space-between; align-items: center; }
    #chat-header .close-chat-btn { background: none; border: none; color: white; font-size: 1.2rem; cursor: pointer; }
    #chat-output { flex-grow: 1; padding: 15px; overflow-y: auto; font-size: 0.9rem; background-color: #f9f9f9; }
    #chat-output p { margin-bottom: 0.8rem; line-height: 1.4; }
    #chat-output p strong { color: #007BFF; }
    #chat-output p strong:first-child { color: #FF8C00; }
    #chat-input-container { display: flex; border-top: 1px solid #eee; padding: 10px; background-color: #fff; }
    #chat-input { flex-grow: 1; padding: 0.7rem; border: 1px solid #ddd; border-radius: 6px; margin-right: 8px; font-family: 'Montserrat', sans-serif; }
    #chat-send { background-color: #007BFF; color: white; padding: 0.7rem 1rem; border: none; border-radius: 6px; cursor: pointer; font-weight: 500; transition: background-color 0.3s ease; }
    #chat-send:hover { background-color: #0056b3; }

    .hidden { display: none; }
    .error-message { color: red; font-size: 0.8rem; margin-top: 0.25rem;}

    @media (max-width: 1024px) { 
      .container-grid { grid-template-columns: 1fr; }
      .sidebar-tools, .sidebar-milestones { max-height: 300px; margin-bottom: 1rem; }
       main.main-subpage-content { order: -1; }
    }
    @media (max-width: 768px) { 
        header { flex-direction: column; gap: 0.5rem; padding: 0.8rem 1rem; }
        nav { flex-wrap: wrap; justify-content: center; gap: 0.25rem; } 
        nav a { padding: 0.5rem 0.8rem; } 
        .search-language { width: 100%; justify-content: space-between; margin-top: 0.5rem;}
        .search-language input { flex-grow: 1; margin-right: 0.5rem; }
        .page-title-section h1 { font-size: 1.8rem; }
        .page-title-section p.subtitle { font-size: 0.9rem; }
        .main-subpage-content h2 { font-size: 1.6rem; }
        .wizard-step h3, .wizard-step h4 { font-size: 1.3rem; }
        .action-button { padding: 0.6rem 1.2rem; font-size: 0.9rem;}
    }

  </style>
</head>
<body>
  <header>
    <a href="/SafetyHelp/index.html" class="logo-container">
        <div class="logo">Safety<span class="help">Help</span></div>
    </a>
    <nav>
      <a href="/SafetyHelp/index.html"><i class="fas fa-home nav-icon"></i>Home</a>
      <a href="/SafetyHelp/resources.html"><i class="fas fa-book nav-icon"></i>Resources</a>
      <a href="/SafetyHelp/services.html"><i class="fas fa-concierge-bell nav-icon"></i>Services</a>
      <a href="/SafetyHelp/community.html"><i class="fas fa-users nav-icon"></i>Community</a>
      <a href="/SafetyHelp/about.html"><i class="fas fa-info-circle nav-icon"></i>About</a>
      <a href="/SafetyHelp/contact.html"><i class="fas fa-envelope nav-icon"></i>Contact</a>
      <a href="/SafetyHelp/login.html"><i class="fas fa-sign-in-alt nav-icon"></i>SignUp / Login</a>
    </nav>
    <div class="search-language">
      <input type="text" placeholder="Search...">
      <select>
        <option>English</option>
        <option>isiXhosa</option>
        <option>Afrikaans</option>
      </select>
    </div>
  </header>

  <div class="page-title-section">
    <h1 id="subpage-title">OHS System Management</h1>
    <p class="subtitle" id="subpage-subtitle">Develop and customize your comprehensive OHS Management System documents, aligned with ISO 45001 and South African legislation.</p>
  </div>

  <div class="page-content-container">
    <div class="container-grid">
      <aside class="sidebar-tools">
        <h3 class="sidebar-heading"><i class="fas fa-tools heading-icon"></i>SafetyHelp Tools</h3>
        <div class="sidebar-list-container">
          <ul id="safetyhelp-tools-list">
            <li><a href="/SafetyHelp/pages/construction-compliance.html" data-modulename="Construction Safety" data-detail="Comprehensive safety management for construction projects."><i class="fas fa-hard-hat list-icon"></i>Construction Safety</a></li>
            <li><a href="/SafetyHelp/pages/emergency-response-plan.html" data-modulename="Emergency Planning" data-detail="Develop effective emergency plans."><i class="fas fa-bell list-icon"></i>Emergency Planning</a></li>
            <li><a href="/SafetyHelp/pages/risk-assessment.html" data-modulename="Risk Assessment" data-detail="Identify and control workplace hazards."><i class="fas fa-shield-alt list-icon"></i>Risk Assessment</a></li>
            <li><a href="/SafetyHelp/pages/legal-appointments.html" data-modulename="Legal Appointments" data-detail="Manage OHS legal appointments."><i class="fas fa-gavel list-icon"></i>Legal Appointments</a></li>
            <li><a href="/SafetyHelp/pages/incident-management.html" data-modulename="Incident Management" data-detail="Report and investigate incidents."><i class="fas fa-file-medical-alt list-icon"></i>Incident Management</a></li>
            <li><a href="/SafetyHelp/pages/training.html" data-modulename="Training" data-detail="Access OHS training programs."><i class="fas fa-graduation-cap list-icon"></i>Training</a></li>
            <li><a href="/SafetyHelp/pages/inspections-audits.html" data-modulename="Inspections & Audits" data-detail="Conduct workplace inspections and audits."><i class="fas fa-clipboard-check list-icon"></i>Inspections & Audits</a></li>
            <li><a href="/SafetyHelp/pages/suppliers.html" data-modulename="Suppliers" data-detail="Manage supplier OHS compliance."><i class="fas fa-truck list-icon"></i>Suppliers</a></li>
            <li><a href="/SafetyHelp/pages/legislation.html" data-modulename="Legislation" data-detail="Stay updated with OHS legislation."><i class="fas fa-balance-scale list-icon"></i>Legislation</a></li>
            <li><a href="/SafetyHelp/pages/community-tools.html" data-modulename="Community Tools" data-detail="Engage with the OHS community."><i class="fas fa-users list-icon"></i>Community Tools</a></li>
            <li><a href="/SafetyHelp/member-dashboard.html" data-modulename="Member Dashboard" data-detail="Your personalized OHS dashboard."><i class="fas fa-tachometer-alt list-icon"></i>Member Dashboard</a></li>
            <li><a href="/SafetyHelp/pages/ohs-system.html" data-modulename="OHS System Modules" data-detail="Build a comprehensive OHS system."><i class="fas fa-cogs list-icon"></i>OHS System Modules</a></li>
          </ul>
        </div>
      </aside>

      <main class="main-subpage-content">
        <section id="introduction-section">
          <h2><i class="fas fa-info-circle section-icon"></i>Welcome to the OHS System Builder</h2>
          <p>This module is designed to help you create a comprehensive Occupational Health and Safety (OHS) Management System tailored to your organization's needs. By following the steps, you can generate policies, procedures, and other essential documents to ensure compliance with South African legislation (like the OHS Act 85 of 1993) and align with international standards such as ISO 45001.</p>
          <p>Choose one of the methods below to get started. Whether you prefer a guided approach or want to select documents manually, SafetyHelp is here to simplify your compliance journey.</p>
        </section>

        <section id="legal-obligations-section">
          <h2><i class="fas fa-balance-scale section-icon"></i>Key Legal & Standard Obligations for an OHS System</h2>
          <p>A robust OHS Management System addresses various legal and standard requirements. Here are some foundational ones:</p>
          <div class="legal-obligation-item">
            <details>
              <summary><i class="fas fa-landmark"></i>OHS Act 85 of 1993 (South Africa)</summary>
              <div>
                <p><strong>Section 7: Health and Safety Policy:</strong> Mandates employers to prepare a written policy concerning the protection of the health and safety of employees at work, and to bring this policy to the attention of employees.</p>
                <p><strong>Section 8: General duties of employers to their employees:</strong> Requires every employer to provide and maintain, as far as is reasonably practicable, a working environment that is safe and without risk to the health of employees. This includes providing information, instruction, training, and supervision.</p>
                <p><strong>Section 12: Duty to inform:</strong> Employers must ensure employees are made conversant with hazards attached to any work they perform, any article or substance they produce, process, use, handle, store or transport and with the precautionary measures which should be taken.</p>
                <p><a href="https://www.gov.za/documents/occupational-health-and-safety-act" target="_blank" rel="noopener noreferrer">View OHS Act on Gov.za</a></p>
              </div>
            </details>
          </div>
          <div class="legal-obligation-item">
            <details>
              <summary><i class="fas fa-globe"></i>ISO 45001:2018 - OHS Management Systems</summary>
              <div>
                <p><strong>Clause 4: Context of the Organization:</strong> Understanding the organization and its context, needs and expectations of workers and other interested parties, and determining the scope of the OHS management system.</p>
                <p><strong>Clause 5: Leadership and worker participation:</strong> Demonstrating leadership commitment, establishing an OHS policy, assigning roles and responsibilities, and ensuring consultation and participation of workers.</p>
                <p><strong>Clause 6: Planning:</strong> Actions to address risks and opportunities, hazard identification, assessment of OHS risks, determination of legal and other requirements, and setting OHS objectives.</p>
                <p><strong>Clause 7: Support:</strong> Providing resources, ensuring competence, awareness, communication, and documented information.</p>
                <p><strong>Clause 8: Operation:</strong> Operational planning and control, emergency preparedness and response, management of change, outsourcing, procurement, and contractors.</p>
                <p><strong>Clause 9: Performance evaluation:</strong> Monitoring, measurement, analysis, internal audit, and management review.</p>
                <p><strong>Clause 10: Improvement:</strong> Incident, nonconformity and corrective action, and continual improvement.</p>
                <p><a href="https://www.iso.org/standard/63787.html" target="_blank" rel="noopener noreferrer">Learn more about ISO 45001</a></p>
              </div>
            </details>
          </div>
        </section>

        <section id="interaction-choice-section">
          <h2><i class="fas fa-cogs section-icon"></i>How Would You Like to Build Your OHS System?</h2>
          <p>Select your preferred method to start compiling your OHS documentation.</p>
          <div class="interaction-buttons-container">
            <button id="show-automated-wizard-btn" class="action-button action-button-primary">
              <i class="fas fa-magic"></i>Automated Wizard
            </button>
            <button id="show-semi-automated-btn" class="action-button action-button-tertiary">
              <i class="fas fa-tasks-alt"></i>Semi-Automated Selection
            </button>
            <button id="show-manual-btn" class="action-button action-button-secondary">
              <i class="fas fa-list-ul"></i>Manual Selection
            </button>
          </div>
        </section>
        
        <!-- Module-Specific Resources Section (General OHS System Resources) -->
        <section id="module-specific-resources-section">
            <h2><i class="fas fa-book-open section-icon"></i>General OHS System Resources</h2>
            <p>Explore these general resources to deepen your understanding of OHS Management Systems.</p>
            <div class="accordion-container">
                <div class="accordion-item">
                  <button class="accordion-button">
                    <span><i class="fas fa-info-circle fa-fw" style="color: #FF8C00;"></i>Understanding ISO 45001</span>
                    <i class="fas fa-chevron-down"></i>
                  </button>
                  <div class="accordion-content">
                    <div class="resource-item">
                      <h4><i class="fas fa-globe"></i>ISO 45001 Overview</h4>
                      <p>An introduction to the ISO 45001 standard for Occupational Health and Safety Management Systems, its benefits, and key clauses.</p>
                      <div class="links">
                        <a href="https://www.iso.org/iso-45001-occupational-health-and-safety.html" target="_blank" rel="noopener noreferrer"><i class="fas fa-external-link-alt"></i>Visit ISO.org</a>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="accordion-item">
                  <button class="accordion-button">
                    <span><i class="fas fa-balance-scale fa-fw" style="color: #FF8C00;"></i>Key South African OHS Legislation</span>
                    <i class="fas fa-chevron-down"></i>
                  </button>
                  <div class="accordion-content">
                    <div class="resource-item">
                      <h4><i class="fas fa-landmark"></i>Department of Employment and Labour</h4>
                      <p>Access official resources, acts, and regulations related to occupational health and safety in South Africa.</p>
                      <div class="links">
                        <a href="https://www.labour.gov.za/" target="_blank" rel="noopener noreferrer"><i class="fas fa-external-link-alt"></i>Visit DoEL Website</a>
                      </div>
                    </div>
                  </div>
                </div>
                 <div class="accordion-item">
                  <button class="accordion-button">
                    <span><i class="fas fa-tools fa-fw" style="color: #FF8C00;"></i>Other SafetyHelp Tools</span>
                    <i class="fas fa-chevron-down"></i>
                  </button>
                  <div class="accordion-content" id="other-safetyhelp-tools-list">
                      <p>Explore other specialized modules within SafetyHelp to address specific OHS needs:</p>
                      <!-- This list will be similar to the sidebar tools list -->
                  </div>
                </div>
            </div>
        </section>


        <!-- Manual Selection Section (Populated with OHS System Structure) -->
        <section id="manual-selection-section" class="hidden">
          <h2><i class="fas fa-list-ul section-icon"></i>Manual Document Selection for OHS System</h2>
          <p>Browse the categories below and select the specific documents you need to build your OHS Management System. Once selected, you can proceed to customize them with your company's information.</p>
          <div class="select-all-buttons">
            <button id="manual-select-all" class="action-button action-button-tertiary btn-sm"><i class="fas fa-check-double"></i> Select All</button>
            <button id="manual-deselect-all" class="action-button action-button-tertiary btn-sm"><i class="fas fa-times"></i> Deselect All</button>
          </div>
          <div class="document-category-list" id="manual-document-categories">
            <!-- Categories will be dynamically inserted here by JavaScript -->
          </div>
          <div class="nav-buttons">
            <button class="action-button action-button-secondary wizard-prev-btn">Back to Choices</button>
            <button id="manual-proceed-btn" class="action-button action-button-primary">Proceed to Company Details <i class="fas fa-arrow-right"></i></button>
          </div>
        </section>

        <!-- Automated Wizard Section -->
        <section id="automated-wizard-section" class="hidden">
          <h2><i class="fas fa-magic section-icon"></i>Automated OHS System Wizard</h2>
          
          <div id="wizard-step-1-auto" class="wizard-step"> <!-- Unique ID for automated wizard step 1 -->
            <h3>Step 1: Your Role & OHS Experience</h3>
            <div class="form-group">
              <label for="auto-user-role">Your Primary Role:</label>
              <select id="auto-user-role" name="user-role">
                <option value="">-- Select Your Role --</option>
                <option value="owner_ceo_director">Company Owner / CEO / Director</option>
                <option value="ohs_professional">OHS Professional</option>
                <option value="contractor">Contractor</option>
                <option value="client_property_owner">Client / Property Owner</option>
                <option value="employer_manager">Employer / Line Manager</option>
                <option value="employee_worker">Employee / Worker</option>
                <option value="community_leader">Community Leader</option>
                <option value="student_trainee">Student / Trainee</option>
                <option value="other">Other</option>
              </select>
              <p class="error-message hidden" id="auto-user-role-error">Please select your role.</p>
            </div>
            <div class="form-group">
              <label for="auto-ohs-knowledge">Your OHS Knowledge Level:</label>
              <select id="auto-ohs-knowledge" name="ohs-knowledge">
                <option value="">-- Select Knowledge Level --</option>
                <option value="beginner">Novice Navigator (New to OHS)</option>
                <option value="intermediate">Seasoned Practitioner (Some Experience)</option>
                <option value="advanced">Expert Strategist (In-depth Knowledge)</option>
              </select>
              <p class="error-message hidden" id="auto-ohs-knowledge-error">Please select your OHS knowledge level.</p>
            </div>
            <div class="form-group">
                <label for="auto-role-experience">Years of Experience in Current Role:</label>
                <select id="auto-role-experience" name="role-experience">
                    <option value="">-- Select Experience --</option>
                    <option value="0-1">&lt; 1 year</option>
                    <option value="1-3">1-3 years</option>
                    <option value="3-5">3-5 years</option>
                    <option value="5+">5+ years</option>
                </select>
                <p class="error-message hidden" id="auto-role-experience-error">Please select your years of experience.</p>
            </div>
            <div class="nav-buttons">
              <button class="action-button action-button-secondary wizard-prev-btn">Back to Choices</button>
              <button class="action-button action-button-primary wizard-next-btn">Next <i class="fas fa-arrow-right"></i></button>
            </div>
          </div>

          <div id="wizard-step-2-auto" class="wizard-step hidden">
            <h3>Step 2: Company Profile</h3>
            <div class="form-group">
              <label for="auto-industry-type">Primary Industry:</label>
              <select id="auto-industry-type" name="industry-type">
                <option value="">-- Select Industry --</option>
                <option value="office_administrative">Office / Administrative</option>
                <option value="retail_shops">Retail / Shops (including Spaza Shops)</option>
                <option value="hospitality_restaurants_hotels">Hospitality (Restaurants, Hotels)</option>
                <option value="construction_small_residential">Construction (Small Residential)</option>
                <option value="construction_commercial_industrial">Construction (Commercial / Industrial)</option>
                <option value="manufacturing_light">Manufacturing (Light)</option>
                <option value="manufacturing_heavy">Manufacturing (Heavy)</option>
                <option value="mining_surface">Mining (Surface)</option>
                <option value="mining_underground">Mining (Underground)</option>
                <option value="agriculture_farming">Agriculture / Farming</option>
                <option value="healthcare_clinics_hospitals">Healthcare (Clinics, Hospitals)</option>
                <option value="education_schools_universities">Education (Schools, Universities)</option>
                <option value="transport_logistics">Transport & Logistics</option>
                <option value="chemical_petrochemical">Chemical / Petrochemical</option>
                <option value="community_religious_orgs">Community / Religious Organizations / NPOs</option>
                <option value="other_industry">Other</option>
              </select>
              <p class="error-message hidden" id="auto-industry-type-error">Please select your industry.</p>
            </div>
             <div class="form-group">
                <label for="auto-company-status">Company Status:</label>
                <select id="auto-company-status" name="company-status">
                    <option value="">-- Select Status --</option>
                    <option value="new_venture">New Venture (Just Starting/Planning)</option>
                    <option value="established_lessthan_2_years">Established Business (Operating < 2 years)</option>
                    <option value="mature_organization">Mature Organization (Operating > 2 years)</option>
                </select>
                <p class="error-message hidden" id="auto-company-status-error">Please select your company status.</p>
            </div>
            <div class="form-group">
              <label for="auto-employee-count">Number of Employees:</label>
              <select id="auto-employee-count" name="employee-count">
                <option value="">-- Select Number of Employees --</option>
                <option value="1-10">1-10</option>
                <option value="11-50">11-50</option>
                <option value="51-200">51-200</option>
                <option value="201-500">201-500</option>
                <option value="500+">500+</option>
              </select>
              <p class="error-message hidden" id="auto-employee-count-error">Please select the number of employees.</p>
            </div>
            <div class="nav-buttons">
              <button class="action-button action-button-secondary wizard-prev-btn">Back <i class="fas fa-arrow-left"></i></button>
              <button class="action-button action-button-primary wizard-next-btn">Get Recommendations <i class="fas fa-arrow-right"></i></button>
            </div>
          </div>

          <div id="wizard-step-3-auto" class="wizard-step hidden">
            <h3>Step 3: OHS System Recommendations</h3>
            <div id="automated-recommendation-explanation" class="recommendation-explanation">
                <!-- Explanatory text will be populated here -->
            </div>
            <p>Based on your input, we recommend the following documents. All are selected by default. You can deselect items or customize further.</p>
            <div class="select-all-buttons">
                <button id="auto-select-all" class="action-button action-button-tertiary btn-sm"><i class="fas fa-check-double"></i> Select All</button>
                <button id="auto-deselect-all" class="action-button action-button-tertiary btn-sm"><i class="fas fa-times"></i> Deselect All</button>
            </div>
            <div id="automated-document-recommendations" class="document-category-list">
              <!-- Recommendations will be populated here by JavaScript, categorized -->
            </div>
            <p class="error-message hidden" id="automated-documents-error">Please select at least one document.</p>
            <div class="nav-buttons">
              <button class="action-button action-button-secondary wizard-prev-btn">Back <i class="fas fa-arrow-left"></i></button>
              <button id="auto-customize-further-btn" class="action-button action-button-tertiary">Customize Further <i class="fas fa-edit"></i></button>
              <button class="action-button action-button-primary wizard-next-btn">Proceed to Company Details <i class="fas fa-arrow-right"></i></button>
            </div>
          </div>
        </section>

        <!-- Semi-Automated Selection Section -->
        <section id="semi-automated-selection-section" class="hidden">
            <h2><i class="fas fa-tasks-alt section-icon"></i>Semi-Automated OHS System Builder</h2>
            <div id="semi-wizard-step-1" class="wizard-step">
                <h3>Step 1: Identify Key OHS Focus Areas</h3>
                <p>Select the main areas of OHS management relevant to your organization. This will help us suggest relevant document categories.</p>
                <div class="form-group">
                    <div class="checkbox-group">
                        <label><input type="checkbox" name="focus-area" value="policy_leadership"> Policy & Leadership</label>
                        <label><input type="checkbox" name="focus-area" value="planning_risk_management"> Planning & Risk Management</label>
                        <label><input type="checkbox" name="focus-area" value="implementation_operation"> Implementation & Operation</label>
                        <label><input type="checkbox" name="focus-area" value="emergency_preparedness"> Emergency Preparedness</label>
                        <label><input type="checkbox" name="focus-area" value="checking_monitoring"> Checking & Monitoring (Incidents, Audits)</label>
                        <label><input type="checkbox" name="focus-area" value="system_review_improvement"> System Review & Improvement</label>
                    </div>
                    <p class="error-message hidden" id="focus-area-error">Please select at least one focus area.</p>
                </div>
                <div class="nav-buttons">
                     <button class="action-button action-button-secondary wizard-prev-btn">Back to Choices</button>
                    <button class="action-button action-button-primary wizard-next-btn">Next <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
            <div id="semi-wizard-step-2" class="wizard-step hidden">
                <h3>Step 2: Select Relevant Document Categories</h3>
                <p>Based on your focus areas, we suggest these document categories. Refine your selection.</p>
                 <div class="select-all-buttons">
                    <button id="semi-cat-select-all" class="action-button action-button-tertiary btn-sm"><i class="fas fa-check-double"></i> Select All Categories</button>
                    <button id="semi-cat-deselect-all" class="action-button action-button-tertiary btn-sm"><i class="fas fa-times"></i> Deselect All Categories</button>
                </div>
                <div id="semi-automated-category-recommendations" class="document-category-list">
                    <!-- Categories will be populated here -->
                </div>
                 <p class="error-message hidden" id="semi-categories-error">Please select at least one document category.</p>
                <div class="nav-buttons">
                    <button class="action-button action-button-secondary wizard-prev-btn">Back <i class="fas fa-arrow-left"></i></button>
                    <button class="action-button action-button-primary wizard-next-btn">Next <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
            <div id="semi-wizard-step-3" class="wizard-step hidden">
                <h3>Step 3: Select Specific Documents</h3>
                <p>Choose the specific documents you need from the selected categories. Recommended documents based on common needs are pre-selected.</p>
                 <div class="select-all-buttons">
                    <button id="semi-doc-select-all" class="action-button action-button-tertiary btn-sm"><i class="fas fa-check-double"></i> Select All Documents</button>
                    <button id="semi-doc-deselect-all" class="action-button action-button-tertiary btn-sm"><i class="fas fa-times"></i> Deselect All Documents</button>
                </div>
                <div id="semi-automated-document-selection" class="document-category-list">
                    <!-- Specific documents will be populated here -->
                </div>
                <p class="error-message hidden" id="semi-documents-error">Please select at least one document.</p>
                <div class="nav-buttons">
                    <button class="action-button action-button-secondary wizard-prev-btn">Back <i class="fas fa-arrow-left"></i></button>
                    <button class="action-button action-button-primary wizard-next-btn">Proceed to Company Details <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
        </section>
        
        <!-- Common Step: Company Details -->
        <section id="company-details-section" class="wizard-step hidden">
            <h3>Enter Company Information</h3>
            <p>Please provide the following details to customize your OHS documents.</p>
            <div class="form-group">
                <label for="company-name">Company Name:</label>
                <input type="text" id="company-name" name="company-name" required>
                <p class="error-message hidden" id="company-name-error">Company name is required.</p>
            </div>
            <div class="form-group">
                <label for="company-reg-number">Company Registration Number (Optional):</label>
                <input type="text" id="company-reg-number" name="company-reg-number">
            </div>
            <div class="form-group">
                <label for="company-address-physical">Physical Address:</label>
                <textarea id="company-address-physical" name="company-address-physical" rows="3" required></textarea>
                <p class="error-message hidden" id="company-address-physical-error">Physical address is required.</p>
            </div>
            <div class="form-group">
                <label for="company-address-postal">Postal Address (Optional):</label>
                <textarea id="company-address-postal" name="company-address-postal" rows="3"></textarea>
            </div>
            <div class="form-group">
                <label for="company-contact-number">Main Contact Number:</label>
                <input type="tel" id="company-contact-number" name="company-contact-number" required>
                <p class="error-message hidden" id="company-contact-number-error">A valid contact number is required.</p>
            </div>
            <div class="form-group">
                <label for="company-email">Main Company Email:</label>
                <input type="email" id="company-email" name="company-email" required>
                 <p class="error-message hidden" id="company-email-error">A valid email is required.</p>
            </div>
            <div class="form-group">
                <label for="company-website">Company Website (Optional):</label>
                <input type="text" id="company-website" name="company-website">
            </div>
            <div class="form-group">
                <label for="ceo-name">Name of CEO / Managing Director (for policy signatures):</label>
                <input type="text" id="ceo-name" name="ceo-name" required>
                <p class="error-message hidden" id="ceo-name-error">CEO/MD name is required.</p>
            </div>
            <div class="form-group">
                <label for="ohs-manager-name">Name of OHS Manager/Representative (Optional):</label>
                <input type="text" id="ohs-manager-name" name="ohs-manager-name">
            </div>
             <div class="form-group">
                <label for="date-first-operated">Date Company First Operated (Approximate if new):</label>
                <input type="date" id="date-first-operated" name="date-first-operated" required>
                <p class="error-message hidden" id="date-first-operated-error">Date of first operation is required.</p>
            </div>
            <div class="form-group">
                <label for="company-turnover">Annual Turnover (Optional, for context):</label>
                <select id="company-turnover" name="company-turnover">
                    <option value="">-- Select Turnover Range --</option>
                    <option value="<R1M">&lt; R1 Million</option>
                    <option value="R1M-R5M">R1 Million - R5 Million</option>
                    <option value="R5M-R20M">R5 Million - R20 Million</option>
                    <option value="R20M-R50M">R20 Million - R50 Million</option>
                    <option value=">R50M">&gt; R50 Million</option>
                </select>
            </div>
             <div class="form-group">
                <label for="project-name">Project Name (if documents are for a specific project, otherwise leave blank):</label>
                <input type="text" id="project-name" name="project-name">
            </div>
            <div class="form-group">
                <label for="site-address">Site Address (if different from company address, or for a specific project):</label>
                <textarea id="site-address" name="site-address" rows="2"></textarea>
            </div>
            <hr style="margin: 2rem 0;">
            <h4>Your Details (Person Compiling)</h4>
            <div class="form-group">
                <label for="compiler-name">Your Full Name:</label>
                <input type="text" id="compiler-name" name="compiler-name" required>
                 <p class="error-message hidden" id="compiler-name-error">Your name is required.</p>
            </div>
             <div class="form-group">
                <label for="compiler-role">Your Role/Designation:</label>
                <input type="text" id="compiler-role" name="compiler-role" required>
                <p class="error-message hidden" id="compiler-role-error">Your role is required.</p>
            </div>
            <div class="form-group">
                <label for="compiler-contact">Your Contact Number:</label>
                <input type="tel" id="compiler-contact" name="compiler-contact" required>
                <p class="error-message hidden" id="compiler-contact-error">Your contact number is required.</p>
            </div>
             <div class="form-group">
                <label for="compiler-email">Your Email Address:</label>
                <input type="email" id="compiler-email" name="compiler-email" required>
                <p class="error-message hidden" id="compiler-email-error">Your email is required.</p>
            </div>
            <div class="form-group">
                <label for="compiler-sacpcmp">SACPCMP Registration Number (if applicable):</label>
                <input type="text" id="compiler-sacpcmp" name="compiler-sacpcmp">
            </div>
            <div class="nav-buttons">
              <button class="action-button action-button-secondary wizard-prev-btn">Back <i class="fas fa-arrow-left"></i></button>
              <button class="action-button action-button-primary wizard-next-btn">Review Documents <i class="fas fa-arrow-right"></i></button>
            </div>
        </section>

        <section id="document-review-section" class="wizard-step hidden">
            <h3>Review Your OHS System Documents</h3>
            <p>Below is a preview of the documents you've selected, populated with your company information. Please review carefully. You can make minor edits here if needed, or download the source files for more extensive changes later.</p>
            <div id="document-preview-area">
                <!-- Document previews will be loaded here by JavaScript -->
            </div>
            <div class="nav-buttons">
              <button class="action-button action-button-secondary wizard-prev-btn">Back <i class="fas fa-arrow-left"></i></button>
              <button class="action-button action-button-primary wizard-next-btn">Finalize & Checkout <i class="fas fa-credit-card"></i></button>
            </div>
        </section>

        <section id="checkout-section" class="wizard-step hidden">
            <h3>Finalize & Download Your OHS System</h3>
            <p>Your OHS Management System documents are ready. Please review the summary below.</p>
            <div class="review-section">
                <h4>Selected Documents:</h4>
                <ul id="final-document-list"></ul>
            </div>
             <div class="review-section">
                <h4>Company Details:</h4>
                <p><strong>Company Name:</strong> <span id="final-company-name"></span></p>
                <p><strong>CEO:</strong> <span id="final-ceo-name"></span></p>
                <p><strong>Compiled By:</strong> <span id="final-compiler-name"></span> (<span id="final-compiler-role"></span>)</p>
            </div>
            <p><em>Disclaimer: These documents are generated based on the information you provided and standard templates. It is your responsibility to ensure they meet all specific legal and operational requirements for your organization. SafetyHelp recommends review by a qualified OHS professional.</em></p>
            <div class="nav-buttons">
              <button class="action-button action-button-secondary wizard-prev-btn">Back <i class="fas fa-arrow-left"></i></button>
              <button id="download-documents-btn" class="action-button action-button-primary"><i class="fas fa-download"></i> Download Documents (PDF)</button>
            </div>
        </section>

      </main>

      <aside class="sidebar-milestones">
        <h3 class="sidebar-heading"><i class="fas fa-flag-checkered heading-icon"></i>OHS Milestones</h3>
        <div class="sidebar-list-container">
          <ul id="ohs-milestones-list">
            <li data-detail="Ancient Egyptians used linen strips to bind wounds, an early form of first aid, reflecting basic safety practices. <a href='https://www.history.com/topics/ancient-egypt' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>3000 BC: Early First Aid (Egypt)</li>
          <li data-detail="Hippocrates documented lead poisoning effects, marking an early recognition of occupational health hazards. <a href='https://www.britannica.com/biography/Hippocrates' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>400 BC: Lead Poisoning (Greece)</li>
          <li data-detail="Pliny the Elder recommended masks for workers exposed to dust, an early OHS intervention. <a href='https://www.britannica.com/biography/Pliny-the-Elder' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>50 AD: Protective Masks (Rome)</li>
          <li data-detail="Khoisan people in South Africa used herbal remedies for injuries, laying foundations for traditional safety practices. <a href='https://www.sahistory.org.za/article/khoisan' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1000 AD: Khoisan Healing (SA)</li>
          <li data-detail="Bantu-speaking peoples developed mining techniques, facing risks like cave-ins, early occupational hazards in SA. <a href='https://www.sahistory.org.za/article/bantu-migration' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1200 AD: Early Mining (SA)</li>
          <li data-detail="The Industrial Revolution increased workplace hazards globally, influencing later OHS developments in SA. <a href='https://www.britannica.com/event/Industrial-Revolution' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1760: Industrial Revolution (Global)</li>
          <li data-detail="UK's Health and Morals of Apprentices Act protected workers, setting a precedent for colonial SA laws. <a href='https://www.parliament.uk/about/living-heritage/transformingsociety/livinglearning/19thcentury' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1802: Apprentices Act (UK)</li>
          <li data-detail="UK Factories Act regulated factory conditions, influencing colonial safety standards in SA. <a href='https://www.bl.uk/collection-items/factory-act-1833' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1833: Factories Act (UK)</li>
          <li data-detail="Gold discovery in SA led to mining towns, increasing occupational risks and need for safety measures. <a href='https://www.sahistory.org.za/article/discovery-gold-1886' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1886: Gold Discovery (SA)</li>
          <li data-detail="SA Mines and Works Act regulated mining safety under colonial rule, addressing rising hazards. <a href='https://www.gov.za/documents/mines-and-works-act' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1911: Mines and Works Act (SA)</li>
          <li data-detail="ILO founded, promoting global workers' safety rights, influencing SA policies post-Union. <a href='https://www.ilo.org/global/about-the-ilo/history' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1919: ILO Founded (Global)</li>
          <li data-detail="SA Workmen's Compensation Act provided injury compensation, a key OHS advancement. <a href='https://www.gov.za/documents/workmens-compensation-act' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1941: Workmen's Compensation (SA)</li>
          <li data-detail="UK Factories Act update set new safety standards, impacting SA's colonial framework. <a href='https://www.legislation.gov.uk/ukpga/Geo6/11-12/55/contents' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1948: Factories Act Update (UK)</li>
          <li data-detail="WHO established, promoting global health and safety, influencing SA's post-apartheid policies. <a href='https://www.who.int/about/history' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1948: WHO Founded (Global)</li>
          <li data-detail="First OHS training programs introduced in SA mines, enhancing worker safety awareness. <a href='https://www.saimm.co.za/history' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1950: OHS Training (SA)</li>
          <li data-detail="Safety audits began in SA mines, formalizing risk management practices. <a href='https://www.mhsc.org.za/about-us/history' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1960: Safety Audits (SA)</li>
          <li data-detail="US OSHA Act set workplace safety standards, influencing SA's later OHS laws. <a href='https://www.osha.gov/laws-regs/oshact/completeoshact' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1970: OSHA (USA)</li>
          <li data-detail="Global ergonomic standards emerged, later adopted in SA for workplace design. <a href='https://www.ergonomics.org/history' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1970: Ergonomics (Global)</li>
          <li data-detail="UK Health and Safety at Work Act influenced SA's modern OHS framework. <a href='https://www.legislation.gov.uk/ukpga/1974/37/contents' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1974: HSWA (UK)</li>
          <li data-detail="SA hosted first OHS conferences, fostering local safety knowledge exchange. <a href='https://www.iosh.com/about-us/our-history' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1980: OHS Conferences (SA)</li>
          <li data-detail="Bhopal disaster highlighted chemical safety needs, prompting SA regulations. <a href='https://www.britannica.com/event/Bhopal-disaster' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1984: Bhopal Disaster (India)</li>
          <li data-detail="Chernobyl accident emphasized high-risk industry safety, impacting SA mining. <a href='https://www.world-nuclear.org/information-library/safety-and-security/safety-of-plants/chernobyl-accident.aspx' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1986: Chernobyl (USSR)</li>
          <li data-detail="Piper Alpha disaster led to offshore safety reforms, influencing SA's oil sector. <a href='https://www.hse.gov.uk/offshore/piper-alpha-disaster.htm' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1988: Piper Alpha (UK)</li>
          <li data-detail="First OHS software tools developed globally, adopted later in SA for risk assessment. <a href='https://www.ehstoday.com/safety-technology/article/21917342/the-evolution-of-safety-technology' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1990: OHS Software (Global)</li>
          <li data-detail="SA OHS Act No. 85 of 1993 established modern safety responsibilities post-apartheid. <a href='https://www.gov.za/documents/occupational-health-and-safety-act' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1993: OHS Act (SA)</li>
          <li data-detail="SA COIDA amended, improving worker compensation and rehabilitation processes. <a href='https://www.gov.za/documents/compensation-occupational-injuries-and-diseases-act' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>2003: COIDA Amendment (SA)</li>
          <li data-detail="First mobile OHS apps emerged globally, enhancing SA's safety management. <a href='https://www.safetyandhealthmagazine.com/articles/18647-safety-apps' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>2010: OHS Mobile Apps (Global)</li>
          <li data-detail="SA Construction Regulations updated, improving site safety standards. <a href='https://www.labour.gov.za/DocumentCenter/Regulations%202014/Construction%20Regulations%202014.pdf' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>2014: Construction Regs (SA)</li>
          <li data-detail="GHS adopted globally for chemical safety, implemented in SA industries. <a href='https://www.unece.org/trans/danger/publi/ghs/ghs_welcome.html' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>2015: Global Harmonization (GHS)</li>
          <li data-detail="VR training programs introduced globally, later used in SA for safety education. <a href='https://www.osha.gov/virtual-reality' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>2015: VR Training (Global)</li>
          <li data-detail="COVID-19 protocols introduced worldwide, reshaping SA workplace safety. <a href='https://www.who.int/emergencies/diseases/novel-coronavirus-2019' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>2020: COVID-19 Protocols</li>
          <li data-detail="SA deployed AI-powered safety monitoring in mines, advancing risk prevention. <a href='https://www.miningreview.com/technology/ai-in-mining-safety/' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>2020: AI Safety Monitoring (SA)</li>
          <li data-detail="Global focus on workplace mental health recognized in SA OHS policies. <a href='https://www.who.int/news-room/fact-sheets/detail/mental-health-at-work' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>2022: Mental Health Focus</li>
          <li data-detail="Blockchain introduced for OHS records globally, adopted in SA for transparency. <a href='https://www.osha.gov/blockchain' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>2022: Blockchain OHS (Global)</li>
          <li data-detail="SA mines used drones for safety inspections, improving hazard detection. <a href='https://www.mining-technology.com/features/drones-in-mining/' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>2023: Drone Inspections (SA)</li>
          <li data-detail="5G enabled real-time safety monitoring globally, adopted in SA industries. <a href='https://www.safetyandhealthmagazine.com/articles/5g-safety' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>2024: 5G Safety Monitoring (Global)</li>
          <li data-detail="Safety helmets introduced globally, widely used in SA construction. <a href='https://www.constructiondive.com/news/history-of-hard-hats/557118/' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1930: Safety Helmets (Global)</li>
          <li data-detail="Steel-toe safety shoes developed globally, adopted in SA mining. <a href='https://www.ishn.com/articles/105586-the-evolution-of-safety-footwear' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1940: Safety Shoes (Global)</li>
          <li data-detail="First aid formalized globally, influencing SA workplace emergency practices. <a href='https://www.redcross.org/about-us/who-we-are/history.html' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1863: First Aid (Global)</li>
          <li data-detail="Dust masks introduced globally, used in SA mines to reduce respiratory risks. <a href='https://www.cdc.gov/niosh/topics/respirators/history.html' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1900: Dust Masks (Global)</li>
          <li data-detail="SA mining regulations tightened post-apartheid, focusing on worker safety. <a href='https://www.mhsc.org.za/legislation' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>1996: Mining Safety (SA)</li>
          <li data-detail="SA introduced silica dust controls in mines, addressing health hazards. <a href='https://www.saimm.co.za/Journal/v115n10p885.pdf' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>2000: Silica Dust Control (SA)</li>
          <li data-detail="SA adopted international noise control standards in workplaces. <a href='https://www.labourguide.co.za/noise-induced-hearing-loss' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>2005: Noise Control (SA)</li>
          <li data-detail="Global push for green safety practices influenced SA's sustainability focus. <a href='https://www.un.org/sustainabledevelopment/' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>2010: Green Safety (Global)</li>
          <li data-detail="SA implemented fatigue management in transport and mining sectors. <a href='https://www.rtms-sa.org/fatigue-management' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>2015: Fatigue Management (SA)</li>
          <li data-detail="Wearable safety tech emerged globally, used in SA for worker monitoring. <a href='https://www.safetyandhealthmagazine.com/articles/wearable-technology' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>2018: Wearable Tech (Global)</li>
          <li data-detail="SA enhanced construction crane safety regulations after incidents. <a href='https://www.labour.gov.za/construction-safety' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>2019: Crane Safety (SA)</li>
          <li data-detail="Quantum computing explored for OHS risk modeling, future potential for SA. <a href='https://www.nature.com/articles/s41586-021-03398-4' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>2025: Quantum OHS (Global)</li>
          <li data-detail="SA planned national OHS digital platform, aligning with SafetyHelp goals. <a href='https://www.gov.za/speeches/ohs-digitalisation' target='_blank'>Source</a>"><i class="fas fa-landmark list-icon"></i>2025: OHS Digital Plan (SA)</li>
            </ul>
        </div>
      </aside>
    </div>
  </div>

  <footer>
    <p>&copy; <span id="copyright-year"></span> SafetyHelp. All rights reserved. Your Partner in Occupational Health and Safety Compliance.</p>
    <p><a href="/SafetyHelp/privacy.html">Privacy Policy</a> | <a href="/SafetyHelp/terms.html">Terms of Service</a> | <a href="/SafetyHelp/contact.html">Contact Us</a></p>
  </footer>

  <div id="infoModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h4 id="modalTitle">Milestone Detail</h4>
        <span class="close-btn" onclick="closeModal()">&times;</span>
      </div>
      <div class="modal-body" id="modalBody"></div>
      <div class="modal-footer">
        <button onclick="closeModal()" class="action-button action-button-secondary"><i class="fas fa-times"></i>Close</button>
      </div>
    </div>
  </div>

  <div class="chatbot-container">
      <div id="chat-window" class="chat-hidden">
          <div id="chat-header">
              <span>Salatiso - Your OHS Assistant</span>
              <button class="close-chat-btn" onclick="toggleChatbot(false)">&times;</button>
          </div>
          <div id="chat-output">
              <p><strong>Salatiso:</strong> Hello! How can I help you with OHS today?</p>
          </div>
          <div id="chat-input-container">
              <input id="chat-input" type="text" placeholder="Ask about OHS...">
              <button id="chat-send"><i class="fas fa-paper-plane"></i></button>
          </div>
      </div>
      <button id="chat-toggle" onclick="toggleChatbot()">
          <i class="fas fa-headset"></i>
      </button>
  </div>

<script>
  // Wrapped all JS in DOMContentLoaded
  document.addEventListener('DOMContentLoaded', function () {
    // --- Basic Setup ---
    const copyrightYearEl = document.getElementById('copyright-year');
    if (copyrightYearEl) {
        copyrightYearEl.textContent = new Date().getFullYear();
    }
    
    const modal = document.getElementById('infoModal');
    const modalTitleEl = document.getElementById('modalTitle');
    const modalBodyEl = document.getElementById('modalBody');

    function handleMilestoneClick(item) {
        const title = item.textContent.trim().replace(/^.*? /, ''); 
        const detail = item.dataset.detail || "More information about this milestone will be available soon.";
        if (modalTitleEl) modalTitleEl.textContent = `OHS Milestone: ${title}`;
        if (modalBodyEl) modalBodyEl.innerHTML = `<p>${detail.replace(/<a href=/g, '<a target="_blank" rel="noopener noreferrer" href=')}</p>`;
        if (modal) modal.style.display = 'block';
    }

    function setupMilestonesScrolling(listId) {
        const listElement = document.getElementById(listId);
        if (!listElement || listElement.children.length === 0) return;
        const originalItems = Array.from(listElement.children);
        if (originalItems.length === 0) return;
        
        // Clone items only if there's enough content to make scrolling appear continuous
        const listContainer = listElement.parentElement;
        if (listElement.offsetHeight > listContainer.offsetHeight) {
            originalItems.forEach(item => {
                const clone = item.cloneNode(true);
                clone.addEventListener('click', () => handleMilestoneClick(clone));
                listElement.appendChild(clone);
            });
            const duration = Math.max(20, Math.round(listElement.offsetHeight / 30)); // Adjusted speed
            listElement.style.animation = `continuousScrollUp ${duration}s linear infinite`;
        }
        
        originalItems.forEach(item => {
            item.addEventListener('click', () => handleMilestoneClick(item));
        });
    }
    setupMilestonesScrolling('ohs-milestones-list');

    window.closeModal = function() {
      if (modal) modal.style.display = 'none';
      const customMsgModal = document.getElementById('customMessageModal');
      if (customMsgModal) customMsgModal.remove();
    }
    window.onclick = function(event) {
      if (event.target == modal) closeModal();
      const customMsgModal = document.getElementById('customMessageModal');
      if (event.target == customMsgModal) closeModal();
    }

    // --- Chatbot ---
    const chatWindow = document.getElementById('chat-window');
    const chatToggleBtn = document.getElementById('chat-toggle');
    const chatInputEl = document.getElementById('chat-input');
    const chatSendBtn = document.getElementById('chat-send');
    const chatOutputEl = document.getElementById('chat-output');
    let chatbotIsVisible = false; 

    window.toggleChatbot = function(forceState) { 
      if (!chatWindow || !chatToggleBtn) return;
      const shouldOpen = forceState !== undefined ? forceState : !chatbotIsVisible;
      chatWindow.classList.toggle('chat-hidden', !shouldOpen);
      chatWindow.classList.toggle('chat-expanded', shouldOpen);
      chatToggleBtn.innerHTML = shouldOpen ? '<i class="fas fa-times"></i>' : '<i class="fas fa-headset"></i>';
      if (shouldOpen && chatInputEl) chatInputEl.focus();
      chatbotIsVisible = shouldOpen;
    }

    function addChatMessageToUI(sender, message, isUser) { 
        if (!chatOutputEl) return;
        const messageEl = document.createElement('p');
        messageEl.innerHTML = `<strong>${sender}:</strong> ${message}`;
        if(isUser) {
            messageEl.style.textAlign = "right"; 
            messageEl.style.color = "#333"; 
        } else {
            messageEl.style.color = "#0056b3"; 
        }
        chatOutputEl.appendChild(messageEl);
        chatOutputEl.scrollTop = chatOutputEl.scrollHeight; 
    }
    async function handleChatSend() { 
        if (!chatInputEl || !chatOutputEl) return;
        const message = chatInputEl.value.trim();
        if (!message) return;
        addChatMessageToUI("You", message, true);
        chatInputEl.value = '';
        let botResponse = "I'm processing your request... For complex queries, please refer to our detailed resources or contact support.";
        if (message.toLowerCase().includes("hello") || message.toLowerCase().includes("hi")) {
            botResponse = "Hello there! How can I assist you with your OHS needs today?";
        } else if (message.toLowerCase().includes("construction compliance")) {
            botResponse = "For Construction Compliance, you can use our Automated Wizard or Manual Selection tools. What specific document are you looking for? You can find these options in the main content area.";
        } else if (message.toLowerCase().includes("risk assessment")) {
            botResponse = "Our Risk Assessment tool can be found in the 'SafetyHelp Tools' sidebar, or you can use the wizard on this page if it's related to the current module.";
        }
        setTimeout(() => { 
            addChatMessageToUI("Salatiso", botResponse, false);
        }, 500 + Math.random() * 500);
    }
    if (chatSendBtn) chatSendBtn.addEventListener('click', handleChatSend);
    if (chatInputEl) chatInputEl.addEventListener('keypress', e => { if (e.key === 'Enter') handleChatSend(); });
    if (chatWindow) {
        chatWindow.classList.add('chat-hidden'); 
        chatWindow.classList.remove('chat-expanded');
    }
    if (chatToggleBtn) chatToggleBtn.innerHTML = '<i class="fas fa-headset"></i>';

    // --- OHS System Module Specific Logic ---
    const interactionChoiceSection = document.getElementById('interaction-choice-section');
    const manualSelectionSection = document.getElementById('manual-selection-section');
    const automatedWizardSection = document.getElementById('automated-wizard-section');
    const semiAutomatedSelectionSection = document.getElementById('semi-automated-selection-section');
    const companyDetailsSection = document.getElementById('company-details-section');
    const documentReviewSection = document.getElementById('document-review-section');
    const checkoutSection = document.getElementById('checkout-section');
    const moduleSpecificResourcesSection = document.getElementById('module-specific-resources-section');


    const allProcessSections = [ // Sections that are part of a "process flow"
        manualSelectionSection, automatedWizardSection, semiAutomatedSelectionSection, 
        companyDetailsSection, documentReviewSection, checkoutSection
    ];
    const mainContentSections = [ // Sections visible by default or as primary content
        interactionChoiceSection, moduleSpecificResourcesSection, document.getElementById('introduction-section'), document.getElementById('legal-obligations-section')
    ];


    let currentWizardMode = ''; // 'manual', 'automated', 'semi-automated'
    let currentWizardStepIndex = 0; // Index for steps within a specific mode/section
    let activeWizardSteps = []; // Holds the DOM elements of steps for the current mode
    let selectedDocuments = []; // Array of document IDs
    let companyData = {}; // To store user input for company details

    // OHS System Document Structure (from OHS_System-Standards.txt)
    const ohsSystemCategories = {
        "1": { name: "OHS Policy", icon: "fas fa-file-signature", documents: [
            { id: "ohs_policy_document", name: "OHS Policy Document", description: "Overall statement of OHS commitment, signed by CEO."}
        ]},
        "2": { name: "Planning", icon: "fas fa-tasks", subcategories: {
            "2.1": { name: "Hazard Identification, Risk Assessment and Mitigation", icon: "fas fa-shield-virus", documents: [
                { id: "hira_procedure", name: "HIRA Procedure", description: "Systematic process for identifying hazards, assessing risks, and implementing controls." },
                { id: "risk_assessment_template", name: "Risk Assessment Template", description: "Standard form for conducting and documenting risk assessments." },
                { id: "risk_register_template", name: "Risk Register Template", description: "Central log of identified risks, their ratings, and control measures." }
            ]},
            "2.2": { name: "Legal and other requirements", icon: "fas fa-gavel", documents: [
                { id: "legal_register_template", name: "Legal Register Template", description: "Inventory of applicable OHS legislation and other requirements." },
                { id: "compliance_evaluation_checklist", name: "Compliance Evaluation Checklist", description: "Tool to periodically assess adherence to legal and other requirements." }
            ]},
            "2.3": { name: "OHS Objectives and Targets", icon: "fas fa-bullseye-arrow", documents: [ // Changed icon
                { id: "ohs_objectives_procedure", name: "OHS Objectives Setting Procedure", description: "Process for establishing, monitoring, and reviewing OHS goals." },
                { id: "objectives_tracker_template", name: "OHS Objectives Tracker Template", description: "Form to document and monitor progress towards OHS targets." }
            ]}
        }},
        "3": { name: "Implementation and Operation", icon: "fas fa-cogs", subcategories: {
            "3.1": { name: "Resources and Roles", icon: "fas fa-users-cog", documents: [
                { id: "roles_responsibilities_procedure", name: "OHS Roles & Responsibilities Procedure", description: "Defines OHS duties for all personnel levels." },
                { id: "appointment_letter_16_1", name: "16.1 CEO Appointment Letter Template", description: "Formal appointment of the CEO for OHS accountability." },
                { id: "appointment_letter_16_2", name: "16.2 Appointee Letter Template", description: "Template for delegating specific OHS duties." }
            ]},
            "3.2": { name: "Training, Awareness and Competence", icon: "fas fa-chalkboard-teacher", documents: [ // Changed icon
                { id: "training_procedure", name: "OHS Training & Competency Procedure", description: "Process for identifying training needs and ensuring worker competence." },
                { id: "training_matrix_template", name: "Training Matrix Template", description: "Plan outlining required OHS training for different roles." },
                { id: "induction_checklist_template", name: "OHS Induction Checklist Template", description: "Checklist for new employee/contractor OHS orientation." }
            ]},
            "3.3": { name: "Communication, Participation and Consultation", icon: "fas fa-bullhorn", documents: [ // Changed icon
                { id: "communication_procedure", name: "OHS Communication & Consultation Procedure", description: "Process for internal/external OHS communication and worker consultation." },
                { id: "hs_committee_agenda_minutes_template", name: "H&S Committee Meeting Agenda/Minutes Template", description: "Standard templates for H&S committee meetings." }
            ]},
            "3.4": { name: "OHS Management System Documentation", icon: "fas fa-book-reader", documents: [ // Changed icon
                { id: "document_control_procedure", name: "Document Control Procedure", description: "Process for creating, approving, distributing, and revising OHS documents." },
                { id: "ohs_manual_template", name: "OHS System Manual Template", description: "Main document outlining the framework of the OHS management system." }
            ]},
            "3.5": { name: "Emergency Preparedness and Response", icon: "fas fa-first-aid", documents: [ // Changed icon
                { id: "emergency_plan_template", name: "Emergency Response Plan Template", description: "Comprehensive plan for handling various workplace emergencies." },
                { id: "evacuation_drill_record_template", name: "Evacuation Drill Record Template", description: "Form for documenting emergency evacuation drills and outcomes." }
            ]},
            "3.6": { name: "Supplier/ Contractor OHS Compliance", icon: "fas fa-hard-hat", documents: [ // Changed icon
                { id: "contractor_management_procedure", name: "Contractor OHS Management Procedure", description: "Process for ensuring contractor compliance with OHS standards." },
                { id: "contractor_agreement_s37_2_template", name: "Section 37(2) Agreement Template", description: "Mandatory legal agreement with contractors regarding OHS responsibilities." }
            ]}
        }},
        "4": { name: "Checking", icon: "fas fa-clipboard-check", subcategories: { // Changed icon
            "4.1": { name: "Incident Management", icon: "fas fa-band-aid", documents: [ // Changed icon
                { id: "incident_reporting_investigation_procedure", name: "Incident Reporting & Investigation Procedure", description: "Systematic process for reporting, investigating, and analyzing incidents." },
                { id: "incident_report_form_template", name: "Incident Report Form Template", description: "Standard form for documenting workplace incidents." }
            ]},
            "4.2": { name: "Non-Conformity, Corrective Action and Preventative Action", icon: "fas fa-tools", documents: [ // Changed icon
                { id: "corrective_action_procedure", name: "Corrective & Preventive Action (CAPA) Procedure", description: "Process for addressing OHS system non-conformities." },
                { id: "car_par_form_template", name: "CAR/PAR Form Template", description: "Form for documenting corrective and preventive actions." }
            ]},
            "4.3": { name: "Records", icon: "fas fa-archive", documents: [
                { id: "records_control_procedure", name: "OHS Records Control Procedure", description: "Process for identifying, storing, protecting, retrieving, and disposing of OHS records." }
            ]},
            "4.4": { name: "Audits and Inspections", icon: "fas fa-search", documents: [ // Changed icon
                { id: "audit_inspection_procedure", name: "OHS Audit & Inspection Procedure", description: "Process for conducting internal OHS audits and regular workplace inspections." },
                { id: "audit_checklist_template", name: "OHS Audit Checklist Template", description: "Template to guide internal OHS management system audits." },
                { id: "inspection_checklist_template", name: "Workplace Inspection Checklist Template", description: "Template for routine safety inspections of work areas." }
            ]}
        }},
        "5": { name: "System Review", icon: "fas fa-chart-line", documents: [ // Changed icon
            { id: "management_review_procedure", name: "Management Review Procedure", description: "Process for top management to periodically review the OHS system's suitability, adequacy, and effectiveness." },
            { id: "management_review_minutes_template", name: "Management Review Minutes Template", description: "Template for documenting the inputs, discussions, and outputs of management review meetings." }
        ]}
    };
    
    // --- UI Population Functions ---
    function populateManualSelectionCategories() {
        const container = document.getElementById('manual-document-categories');
        container.innerHTML = ''; 
        for (const catKey in ohsSystemCategories) {
            const category = ohsSystemCategories[catKey];
            const catDetails = document.createElement('details');
            catDetails.className = 'accordion-item-manual'; // For distinct styling if needed
            const catSummary = document.createElement('summary');
            catSummary.innerHTML = `<i class="${category.icon} section-icon"></i> ${catKey}. ${category.name} <i class="fas fa-chevron-down summary-chevron"></i>`;
            catDetails.appendChild(catSummary);
            const catContent = document.createElement('div');
            catContent.style.display = 'none'; // Collapsed by default

            if (category.documents) {
                category.documents.forEach(doc => {
                    catContent.appendChild(createDocumentItemCheckbox(doc.id, doc.name, doc.description, doc.icon || 'fas fa-file-alt', 'manual_doc_'));
                });
            }
            if (category.subcategories) {
                for (const subCatKey in category.subcategories) {
                    const subCategory = category.subcategories[subCatKey];
                    const subCatDetails = document.createElement('details');
                    subCatDetails.className = 'accordion-item-manual-sub';
                    const subCatSummary = document.createElement('summary');
                    subCatSummary.innerHTML = `<i class="${subCategory.icon || 'fas fa-folder'} section-icon" style="margin-left: 1em;"></i> ${subCatKey} ${subCategory.name} <i class="fas fa-chevron-down summary-chevron"></i>`;
                    subCatDetails.appendChild(subCatSummary);
                    const subCatContentInner = document.createElement('div');
                    subCatContentInner.style.display = 'none';
                    subCategory.documents.forEach(doc => {
                        subCatContentInner.appendChild(createDocumentItemCheckbox(doc.id, doc.name, doc.description, doc.icon || 'fas fa-file-invoice', 'manual_doc_'));
                    });
                    subCatDetails.appendChild(subCatContentInner);
                    catContent.appendChild(subCatDetails);
                    subCatSummary.addEventListener('click', (e) => {
                        e.preventDefault();
                        subCatContentInner.style.display = subCatContentInner.style.display === 'none' ? 'block' : 'none';
                        subCatSummary.querySelector('.summary-chevron').classList.toggle('fa-chevron-up', subCatContentInner.style.display === 'block');
                        subCatSummary.querySelector('.summary-chevron').classList.toggle('fa-chevron-down', subCatContentInner.style.display === 'none');
                    });
                }
            }
            catDetails.appendChild(catContent);
            container.appendChild(catDetails);
            catSummary.addEventListener('click', (e) => {
                e.preventDefault(); // Prevent default details toggle to handle it manually
                catContent.style.display = catContent.style.display === 'none' ? 'block' : 'none';
                catSummary.querySelector('.summary-chevron').classList.toggle('fa-chevron-up', catContent.style.display === 'block');
                catSummary.querySelector('.summary-chevron').classList.toggle('fa-chevron-down', catContent.style.display === 'none');
            });
        }
    }

    function createDocumentItemCheckbox(id, name, description, iconClass, prefix = '') {
        const div = document.createElement('div');
        div.className = 'document-item';
        div.innerHTML = `
            <input type="checkbox" id="${prefix}${id}" name="${prefix}documents" value="${id}" class="form-checkbox">
            <div class="document-item-info">
                <label for="${prefix}${id}"><strong><i class="${iconClass}"></i> ${name}</strong></label>
                <p>${description}</p>
            </div>
        `;
        return div;
    }

    // --- Event Listeners for Main Interaction Buttons ---
    document.getElementById('show-manual-btn').addEventListener('click', () => {
        currentWizardMode = 'manual';
        showSection(manualSelectionSection);
        populateManualSelectionCategories();
        activeWizardSteps = [manualSelectionSection]; // Only one "step" before company details
        currentWizardStepIndex = 0;
        updateNavigationButtons();
    });

    document.getElementById('show-automated-wizard-btn').addEventListener('click', () => {
        currentWizardMode = 'automated';
        showSection(automatedWizardSection);
        activeWizardSteps = Array.from(automatedWizardSection.querySelectorAll('.wizard-step'));
        currentWizardStepIndex = 0;
        showCurrentWizardStep();
        updateNavigationButtons();
    });

    document.getElementById('show-semi-automated-btn').addEventListener('click', () => {
        currentWizardMode = 'semi-automated';
        showSection(semiAutomatedSelectionSection);
        activeWizardSteps = Array.from(semiAutomatedSelectionSection.querySelectorAll('.wizard-step'));
        currentWizardStepIndex = 0;
        // TODO: Populate first step of semi-automated (focus areas)
        showCurrentWizardStep();
        updateNavigationButtons();
    });
    
    // --- Navigation and State Logic ---
    function hideAllProcessSections() {
        allProcessSections.forEach(section => section.classList.add('hidden'));
        mainContentSections.forEach(section => section.style.display = 'block'); // Show default sections
    }

    function showSection(sectionElement) {
        mainContentSections.forEach(section => section.style.display = 'none');
        allProcessSections.forEach(section => section.classList.add('hidden'));
        sectionElement.classList.remove('hidden');
    }

    function showCurrentWizardStep() {
        activeWizardSteps.forEach((step, index) => {
            step.classList.toggle('hidden', index !== currentWizardStepIndex);
        });
        updateNavigationButtons(); // Update buttons based on the current step
    }

    function updateNavigationButtons() {
        const currentSection = activeWizardSteps[currentWizardStepIndex]?.closest('section');
        if (!currentSection) return;

        const backBtn = currentSection.querySelector('.wizard-prev-btn');
        const nextBtn = currentSection.querySelector('.wizard-next-btn');
        const manualProceedBtn = document.getElementById('manual-proceed-btn'); // Specific to manual

        if (backBtn) {
            // Show back button if not the first step of the current mode, or if in common steps
            if (currentWizardMode === 'automated' || currentWizardMode === 'semi-automated') {
                 backBtn.style.display = currentWizardStepIndex === 0 ? 'inline-flex' : 'inline-flex'; // Always show for now, first step back goes to choices
                 if(currentWizardStepIndex === 0) backBtn.textContent = "Back to Choices";
                 else backBtn.innerHTML = 'Back <i class="fas fa-arrow-left"></i>';

            } else if (currentSection.id === 'company-details-section' || currentSection.id === 'document-review-section' || currentSection.id === 'checkout-section') {
                 backBtn.style.display = 'inline-flex';
                 backBtn.innerHTML = 'Back <i class="fas fa-arrow-left"></i>';
            } else {
                 backBtn.style.display = 'none'; // Manual selection doesn't have steps before company details
            }
        }
        if (nextBtn) { // General next buttons in wizards
            nextBtn.style.display = 'inline-flex';
        }
        if(manualProceedBtn && currentWizardMode === 'manual'){
            manualProceedBtn.style.display = 'inline-flex';
        } else if (manualProceedBtn) {
            manualProceedBtn.style.display = 'none';
        }
    }
    
    // --- Wizard Step Navigation Logic (Common for Automated & Semi-Automated) ---
    function handleNextStep(wizardType) {
        // TODO: Add validation for current step
        if (!validateCurrentStep(wizardType)) return;

        if (currentWizardStepIndex < activeWizardSteps.length - 1) {
            currentWizardStepIndex++;
            showCurrentWizardStep();
            // Specific logic for populating next steps if needed
            if (wizardType === 'automated' && currentWizardStepIndex === 2) populateAutomatedRecommendations();
            if (wizardType === 'semi-automated' && currentWizardStepIndex === 1) populateSemiAutomatedCategories();
            if (wizardType === 'semi-automated' && currentWizardStepIndex === 2) populateSemiAutomatedDocuments();

        } else { // Reached end of specific wizard, move to common company details
            collectAllSelectedDocuments(); // Finalize document selection
             if (selectedDocuments.length === 0 && wizardType !== 'manual') { // Manual has its own proceed button
                showCustomMessage("Selection Required", "Please select at least one document to proceed.");
                return;
            }
            currentWizardMode = 'common'; // Switch mode for common steps
            activeWizardSteps = [companyDetailsSection, documentReviewSection, checkoutSection];
            currentWizardStepIndex = 0;
            showSection(companyDetailsSection);
            showCurrentWizardStep();
        }
    }

    function handlePrevStep(wizardType) {
        if (currentWizardStepIndex > 0) {
            currentWizardStepIndex--;
            showCurrentWizardStep();
        } else { // Back from the first step of any wizard
            hideAllProcessSections(); // This shows interaction-choice and resources
            currentWizardMode = ''; // Reset mode
        }
    }
    
    // Attach event listeners to wizard navigation buttons
    automatedWizardSection.querySelectorAll('.wizard-next-btn').forEach(btn => btn.addEventListener('click', () => handleNextStep('automated')));
    automatedWizardSection.querySelectorAll('.wizard-prev-btn').forEach(btn => btn.addEventListener('click', () => handlePrevStep('automated')));
    semiAutomatedSelectionSection.querySelectorAll('.wizard-next-btn').forEach(btn => btn.addEventListener('click', () => handleNextStep('semi-automated')));
    semiAutomatedSelectionSection.querySelectorAll('.wizard-prev-btn').forEach(btn => btn.addEventListener('click', () => handlePrevStep('semi-automated')));

    // --- Manual Selection Proceed Button ---
    document.getElementById('manual-proceed-btn')?.addEventListener('click', () => {
        collectAllSelectedDocuments();
        if (selectedDocuments.length === 0) {
            showCustomMessage("Selection Required", "Please select at least one document to proceed.");
            return;
        }
        currentWizardMode = 'common'; // Switch to common steps
        activeWizardSteps = [companyDetailsSection, documentReviewSection, checkoutSection];
        currentWizardStepIndex = 0;
        showSection(companyDetailsSection);
        showCurrentWizardStep();
    });
     // Manual selection back button (if one is added to go back to choices)
    manualSelectionSection.querySelector('.wizard-prev-btn')?.addEventListener('click', () => {
        hideAllProcessSections();
        currentWizardMode = '';
    });


    // --- Common Steps Navigation (Company Details, Review, Checkout) ---
    companyDetailsSection.querySelector('.wizard-next-btn').addEventListener('click', () => {
        if (validateCompanyDetails()) {
            collectCompanyDetails();
            populateReviewSection();
            currentWizardStepIndex = 1; // Index within common steps
            showCurrentWizardStep();
        }
    });
    companyDetailsSection.querySelector('.wizard-prev-btn').addEventListener('click', () => {
        // This needs to intelligently go back to the *last step of the previous mode*
        // For simplicity now, it goes back to interaction choices
        hideAllProcessSections();
        currentWizardMode = '';
    });

    documentReviewSection.querySelector('.wizard-next-btn').addEventListener('click', () => {
        populateCheckoutSection();
        currentWizardStepIndex = 2; // Index within common steps
        showCurrentWizardStep();
    });
    documentReviewSection.querySelector('.wizard-prev-btn').addEventListener('click', () => {
        currentWizardStepIndex = 0; // Back to company details
        showCurrentWizardStep();
    });
    
    checkoutSection.querySelector('.wizard-prev-btn').addEventListener('click', () => {
        currentWizardStepIndex = 1; // Back to review
        showCurrentWizardStep();
    });

    // --- Validation Functions (Placeholders - to be implemented) ---
    function validateCurrentStep(wizardType) {
        // Example: For automated step 1 (role, knowledge, experience)
        if (wizardType === 'automated' && currentWizardStepIndex === 0) {
            let isValid = true;
            const role = document.getElementById('auto-user-role').value;
            const knowledge = document.getElementById('auto-ohs-knowledge').value;
            const experience = document.getElementById('auto-role-experience').value;
            if (!role) { document.getElementById('auto-user-role-error').classList.remove('hidden'); isValid = false; } 
            else { document.getElementById('auto-user-role-error').classList.add('hidden'); }
            if (!knowledge) { document.getElementById('auto-ohs-knowledge-error').classList.remove('hidden'); isValid = false; }
            else { document.getElementById('auto-ohs-knowledge-error').classList.add('hidden'); }
            if (!experience) { document.getElementById('auto-role-experience-error').classList.remove('hidden'); isValid = false; }
            else { document.getElementById('auto-role-experience-error').classList.add('hidden'); }
            return isValid;
        }
        // Add more validation for other steps and modes
        return true; // Default to true for now
    }

    function validateCompanyDetails() { /* ... Same as before ... */ return true;}
    function collectCompanyDetails() { /* ... Same as before ... */ }
    function populateReviewSection() { /* ... Same as before ... */ }
    function findDocumentConcept(docId) { /* ... Same as before ... */ return null; }
    function populateCheckoutSection() { /* ... Same as before ... */ }
    
    // --- Document Recommendation & Population Logic (Placeholders) ---
    function populateAutomatedRecommendations() {
        const container = document.getElementById('automated-document-recommendations');
        container.innerHTML = '<p class="recommendation-explanation">Based on your input, here are your tailored document recommendations. All are selected by default.</p>';
        // TODO: Implement actual recommendation logic based on user inputs
        // For now, add a few example categories and documents
        let exampleDocs = ohsSystemCategories["1"].documents.concat(ohsSystemCategories["2"].subcategories["2.1"].documents);
        
        const recommendations = {}; // Group by category for display
        exampleDocs.forEach(doc => {
            // Find which main category this doc belongs to
            for (const catKey in ohsSystemCategories) {
                const category = ohsSystemCategories[catKey];
                if (category.documents && category.documents.find(d => d.id === doc.id)) {
                    if (!recommendations[catKey]) recommendations[catKey] = { name: category.name, icon: category.icon, documents: [] };
                    recommendations[catKey].documents.push(doc);
                    break;
                }
                if (category.subcategories) {
                    for (const subCatKey in category.subcategories) {
                        if (category.subcategories[subCatKey].documents.find(d => d.id === doc.id)) {
                            if (!recommendations[catKey]) recommendations[catKey] = { name: category.name, icon: category.icon, documents: [] }; // Add main cat if not present
                            // For simplicity, just add to main category list for now
                            recommendations[catKey].documents.push(doc);
                            break;
                        }
                    }
                }
            }
        });

        for (const catKey in recommendations) {
            const category = recommendations[catKey];
            const catDetails = document.createElement('details');
            catDetails.open = true; // Keep them open by default in recommendations
            const catSummary = document.createElement('summary');
            catSummary.innerHTML = `<i class="${category.icon} section-icon"></i> ${category.name} <i class="fas fa-chevron-up summary-chevron"></i>`;
            catDetails.appendChild(catSummary);
            const catContent = document.createElement('div');
            category.documents.forEach(doc => {
                const item = createDocumentItemCheckbox(doc.id, doc.name, doc.description, doc.icon || 'fas fa-file-alt', 'auto_doc_');
                item.querySelector('input').checked = true; // Auto-select
                catContent.appendChild(item);
            });
            catDetails.appendChild(catContent);
            container.appendChild(catDetails);
            catSummary.addEventListener('click', (e) => { /* ... accordion toggle ... */ });
        }
        collectAllSelectedDocuments(); // Update selectedDocuments array
    }

    function populateSemiAutomatedCategories() { /* ... TODO ... */ }
    function populateSemiAutomatedDocuments() { /* ... TODO ... */ }
    
    // --- Select/Deselect All ---
    document.getElementById('manual-select-all')?.addEventListener('click', () => {
        document.querySelectorAll('#manual-document-categories input[type="checkbox"]').forEach(cb => cb.checked = true);
    });
    document.getElementById('manual-deselect-all')?.addEventListener('click', () => {
        document.querySelectorAll('#manual-document-categories input[type="checkbox"]').forEach(cb => cb.checked = false);
    });
    document.getElementById('auto-select-all')?.addEventListener('click', () => {
        document.querySelectorAll('#automated-document-recommendations input[type="checkbox"]').forEach(cb => cb.checked = true);
        collectAllSelectedDocuments();
    });
    document.getElementById('auto-deselect-all')?.addEventListener('click', () => {
        document.querySelectorAll('#automated-document-recommendations input[type="checkbox"]').forEach(cb => cb.checked = false);
        collectAllSelectedDocuments();
    });
    // Add similar for semi-automated steps once populated


    function collectAllSelectedDocuments() {
        selectedDocuments = [];
        let selector = '';
        if (currentWizardMode === 'manual') selector = 'input[name="manual_documents"]:checked';
        else if (currentWizardMode === 'automated' && currentWizardStepIndex === 2) selector = '#automated-document-recommendations input[type="checkbox"]:checked';
        else if (currentWizardMode === 'semi-automated' && currentWizardStepIndex === 2) selector = '#semi-automated-document-selection input[type="checkbox"]:checked';
        
        if (selector) {
            document.querySelectorAll(selector).forEach(cb => {
                selectedDocuments.push(cb.value);
            });
        }
        console.log("Updated selected documents:", selectedDocuments);
    }


    document.getElementById('download-documents-btn')?.addEventListener('click', () => { /* ... Omitted for brevity ... */ });
    function showCustomMessage(title, message) { /* ... Omitted for brevity ... */ }
    
    // Accordion for Module-Specific Resources (General OHS Info)
    document.querySelectorAll('#module-specific-resources-section .accordion-button').forEach(button => { 
        button.addEventListener('click', () => {
            const accordionContent = button.nextElementSibling;
            const icon = button.querySelector('.fas.fa-chevron-down, .fas.fa-chevron-up');
            button.classList.toggle('expanded');
            if (accordionContent.style.display === "block") {
                accordionContent.style.display = "none";
                if(icon) icon.classList.replace('fa-chevron-up', 'fa-chevron-down');
            } else {
                accordionContent.style.display = "block";
                if(icon) icon.classList.replace('fa-chevron-down', 'fa-chevron-up');
                // Optional: Close other accordions in this specific section
                document.querySelectorAll('#module-specific-resources-section .accordion-content').forEach(content => {
                   if (content !== accordionContent) {
                       content.style.display = 'none';
                       const prevButton = content.previousElementSibling;
                       if (prevButton && prevButton.classList.contains('accordion-button')) {
                           prevButton.classList.remove('expanded');
                           const otherIcon = prevButton.querySelector('.fas.fa-chevron-down, .fas.fa-chevron-up');
                           if(otherIcon) otherIcon.classList.replace('fa-chevron-up', 'fa-chevron-down');
                       }
                   }
                });
            }
        });
    });
    
    function setActiveToolLink() { 
        const currentPath = window.location.pathname.toLowerCase();
        const pageTitleEl = document.getElementById('subpage-title');
        let pageModuleTitle = pageTitleEl ? pageTitleEl.textContent.trim().toLowerCase() : "";
        if (pageModuleTitle === "[module name]") { 
            const pathSegments = currentPath.split('/');
            const lastSegment = pathSegments[pathSegments.length - 1];
            if (lastSegment && lastSegment.endsWith('.html')) {
                pageModuleTitle = lastSegment.replace('.html', '').replace(/-/g, ' ');
            } else {
                pageModuleTitle = "ohs system management"; // Fallback for this specific page
            }
        }

        const toolLinks = document.querySelectorAll('#safetyhelp-tools-list li a');
        let activeLink = null;

        toolLinks.forEach(link => {
            link.classList.remove('active-tool-link');
            const linkPath = new URL(link.href, window.location.origin).pathname.toLowerCase();
            const linkModuleName = link.dataset.modulename ? link.dataset.modulename.toLowerCase() : "";

            if (currentPath === linkPath) {
                activeLink = link; return; 
            }
            if (!activeLink && pageModuleTitle && linkModuleName && pageModuleTitle.includes(linkModuleName)) {
                 activeLink = link; 
            }
             // Specifically for OHS System page
            if (!activeLink && pageModuleTitle === "ohs system management" && linkModuleName.includes("ohs system")) {
                activeLink = link;
            }
        });
        
        if (!activeLink && (currentPath === '/safetyhelp/index.html' || currentPath === '/safetyhelp/')) {
             const homeLink = document.querySelector('#safetyhelp-tools-list li a[href="/SafetyHelp/index.html"]');
             if (homeLink) activeLink = homeLink;
        }
        
        if (activeLink) {
            activeLink.classList.add('active-tool-link');
            const listContainer = document.querySelector('.sidebar-tools .sidebar-list-container');
            if (listContainer && activeLink.scrollIntoView) {
                setTimeout(() => { 
                    activeLink.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'nearest' });
                }, 150);
            }
        }
    }
    setActiveToolLink(); 

    // Initial setup
    hideAllProcessSections(); 
    interactionChoiceSection.style.display = 'block';
    if(moduleSpecificResourcesSection) moduleSpecificResourcesSection.style.display = 'block';

    // Populate other SafetyHelp tools list
    const otherToolsListContainer = document.getElementById('other-safetyhelp-tools-list');
    if (otherToolsListContainer) {
        const toolsList = document.getElementById('safetyhelp-tools-list');
        if (toolsList) {
            const links = toolsList.querySelectorAll('li a');
            links.forEach(link => {
                if (link.getAttribute('href') !== "/SafetyHelp/pages/ohs-system.html") { // Exclude current page
                    const toolItem = document.createElement('div');
                    toolItem.className = 'resource-item';
                    toolItem.innerHTML = `
                        <h4><i class="${link.querySelector('.list-icon').className}"></i> ${link.textContent.trim()}</h4>
                        <p>${link.dataset.detail || 'Access this specialized OHS module.'}</p>
                        <div class="links"><a href="${link.href}"><i class="fas fa-arrow-right"></i> Go to Module</a></div>
                    `;
                    otherToolsListContainer.appendChild(toolItem);
                }
            });
        }
    }


  });
</script>
</body>
</html>
